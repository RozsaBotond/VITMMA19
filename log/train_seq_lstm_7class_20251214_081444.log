2025-12-14 08:14:44 | INFO     | Model: seq_lstm
2025-12-14 08:14:44 | INFO     | Mode: 7class (7 classes)
2025-12-14 08:14:44 | INFO     | Data dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/data
2025-12-14 08:14:44 | INFO     | Save dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/models/seq_lstm
2025-12-14 08:14:44 | INFO     | Device: cuda
2025-12-14 08:14:44 | INFO     | Loaded data: X=(720, 256, 4), Y=(720, 256) (balanced=True)
2025-12-14 08:14:44 | INFO     | Class names: ['None', 'Bearish Normal', 'Bearish Wedge', 'Bearish Pennant', 'Bullish Normal', 'Bullish Wedge', 'Bullish Pennant']
2025-12-14 08:14:44 | INFO     |   None: 121231 (65.8%)
2025-12-14 08:14:44 | INFO     |   Bearish Normal: 6805 (3.7%)
2025-12-14 08:14:44 | INFO     |   Bearish Wedge: 11233 (6.1%)
2025-12-14 08:14:44 | INFO     |   Bearish Pennant: 14351 (7.8%)
2025-12-14 08:14:44 | INFO     |   Bullish Normal: 6266 (3.4%)
2025-12-14 08:14:44 | INFO     |   Bullish Wedge: 13240 (7.2%)
2025-12-14 08:14:44 | INFO     |   Bullish Pennant: 11194 (6.1%)
2025-12-14 08:14:44 | INFO     | Config: {'input_size': 4, 'hidden_size': 128, 'num_layers': 2, 'num_classes': 7, 'dropout': 0.2, 'bidirectional': False, 'learning_rate': 0.001, 'batch_size': 16, 'epochs': 100, 'weight_decay': 1e-05, 'use_class_weights': True, 'max_class_weight': 10.0, 'patience': 20, 'min_delta': 0.0001, 'scheduler': 'cosine', 'warmup_epochs': 5, 'label_smoothing': 0.05, 'focal_loss': False, 'focal_gamma': 2.0, 'name': 'seq_lstm', 'description': 'LSTM for per-timestep sequence labeling', 'mode': '7class'}
2025-12-14 08:14:44 | INFO     | Train: 504 samples
2025-12-14 08:14:44 | INFO     | Val:   108 samples
2025-12-14 08:14:44 | INFO     | Test:  108 samples
2025-12-14 08:14:44 | INFO     | Class weights (balanced): [0.12084904313087463, 1.2084904909133911, 1.185412049293518, 0.971321165561676, 1.2084904909133911, 1.0969464778900146, 1.2084904909133911]
2025-12-14 08:14:44 | INFO     | Model parameters: 201,607
2025-12-14 08:14:45 | INFO     | ============================================================
2025-12-14 08:14:45 | INFO     | TRAINING STARTED
2025-12-14 08:14:45 | INFO     | ============================================================
2025-12-14 08:14:46 | INFO     | Epoch   1/100 | Train Loss: 1.9956 Acc: 0.1746 | Val Loss: 1.9590 Acc: 0.1800 F1: 0.0612 | LR: 1.00e-03
2025-12-14 08:14:46 | INFO     |   -> New best model saved (F1: 0.0612)
2025-12-14 08:14:46 | INFO     | Epoch   2/100 | Train Loss: 1.9232 Acc: 0.2361 | Val Loss: 1.9782 Acc: 0.1517 F1: 0.0534 | LR: 9.99e-04
2025-12-14 08:14:46 | INFO     | Epoch   3/100 | Train Loss: 1.9808 Acc: 0.2384 | Val Loss: 1.9026 Acc: 0.5288 F1: 0.1323 | LR: 9.98e-04
2025-12-14 08:14:46 | INFO     |   -> New best model saved (F1: 0.1323)
2025-12-14 08:14:46 | INFO     | Epoch   4/100 | Train Loss: 1.9512 Acc: 0.2543 | Val Loss: 1.9505 Acc: 0.1017 F1: 0.0406 | LR: 9.96e-04
2025-12-14 08:14:47 | INFO     | Epoch   5/100 | Train Loss: 1.9319 Acc: 0.2522 | Val Loss: 1.9132 Acc: 0.2969 F1: 0.1073 | LR: 9.94e-04
2025-12-14 08:14:47 | INFO     | Epoch   6/100 | Train Loss: 1.8873 Acc: 0.2276 | Val Loss: 1.9266 Acc: 0.1240 F1: 0.0439 | LR: 9.91e-04
2025-12-14 08:14:47 | INFO     | Epoch   7/100 | Train Loss: 1.8870 Acc: 0.2239 | Val Loss: 1.8939 Acc: 0.3952 F1: 0.1310 | LR: 9.88e-04
2025-12-14 08:14:47 | INFO     | Epoch   8/100 | Train Loss: 1.9058 Acc: 0.2698 | Val Loss: 1.9496 Acc: 0.1740 F1: 0.1031 | LR: 9.84e-04
2025-12-14 08:14:48 | INFO     | Epoch   9/100 | Train Loss: 1.9142 Acc: 0.2900 | Val Loss: 1.9279 Acc: 0.1293 F1: 0.0591 | LR: 9.80e-04
2025-12-14 08:14:48 | INFO     | Epoch  10/100 | Train Loss: 1.9113 Acc: 0.2072 | Val Loss: 1.9319 Acc: 0.1287 F1: 0.0416 | LR: 9.76e-04
2025-12-14 08:14:48 | INFO     | Epoch  11/100 | Train Loss: 1.9005 Acc: 0.3080 | Val Loss: 1.9241 Acc: 0.6338 F1: 0.1108 | LR: 9.70e-04
2025-12-14 08:14:48 | INFO     | Epoch  12/100 | Train Loss: 1.8785 Acc: 0.2500 | Val Loss: 1.9316 Acc: 0.1289 F1: 0.0530 | LR: 9.65e-04
2025-12-14 08:14:49 | INFO     | Epoch  13/100 | Train Loss: 1.8814 Acc: 0.3246 | Val Loss: 1.9107 Acc: 0.2083 F1: 0.1249 | LR: 9.59e-04
2025-12-14 08:14:49 | INFO     | Epoch  14/100 | Train Loss: 1.8880 Acc: 0.2161 | Val Loss: 1.9237 Acc: 0.2088 F1: 0.0843 | LR: 9.52e-04
2025-12-14 08:14:49 | INFO     | Epoch  15/100 | Train Loss: 1.9260 Acc: 0.2484 | Val Loss: 1.9327 Acc: 0.1050 F1: 0.0526 | LR: 9.46e-04
2025-12-14 08:14:49 | INFO     | Epoch  16/100 | Train Loss: 1.8953 Acc: 0.1875 | Val Loss: 1.8906 Acc: 0.2382 F1: 0.1180 | LR: 9.38e-04
2025-12-14 08:14:50 | INFO     | Epoch  17/100 | Train Loss: 1.8754 Acc: 0.2595 | Val Loss: 1.8834 Acc: 0.4831 F1: 0.1299 | LR: 9.30e-04
2025-12-14 08:14:50 | INFO     | Epoch  18/100 | Train Loss: 1.8680 Acc: 0.3527 | Val Loss: 1.8965 Acc: 0.1726 F1: 0.1054 | LR: 9.22e-04
2025-12-14 08:14:50 | INFO     | Epoch  19/100 | Train Loss: 1.8683 Acc: 0.2747 | Val Loss: 1.9378 Acc: 0.1301 F1: 0.0612 | LR: 9.14e-04
2025-12-14 08:14:50 | INFO     | Epoch  20/100 | Train Loss: 1.8695 Acc: 0.2558 | Val Loss: 1.9236 Acc: 0.5416 F1: 0.1355 | LR: 9.05e-04
2025-12-14 08:14:50 | INFO     |   -> New best model saved (F1: 0.1355)
2025-12-14 08:14:51 | INFO     | Epoch  21/100 | Train Loss: 1.8688 Acc: 0.3879 | Val Loss: 1.9227 Acc: 0.2608 F1: 0.1169 | LR: 8.95e-04
2025-12-14 08:14:51 | INFO     | Epoch  22/100 | Train Loss: 1.8513 Acc: 0.3893 | Val Loss: 1.9193 Acc: 0.4792 F1: 0.1300 | LR: 8.85e-04
2025-12-14 08:14:51 | INFO     | Epoch  23/100 | Train Loss: 1.8406 Acc: 0.3030 | Val Loss: 1.8832 Acc: 0.3266 F1: 0.1513 | LR: 8.75e-04
2025-12-14 08:14:51 | INFO     |   -> New best model saved (F1: 0.1513)
2025-12-14 08:14:51 | INFO     | Epoch  24/100 | Train Loss: 1.8358 Acc: 0.3071 | Val Loss: 1.9306 Acc: 0.2660 F1: 0.1361 | LR: 8.65e-04
2025-12-14 08:14:51 | INFO     | Epoch  25/100 | Train Loss: 1.8673 Acc: 0.2848 | Val Loss: 1.9077 Acc: 0.3884 F1: 0.1453 | LR: 8.54e-04
2025-12-14 08:14:52 | INFO     | Epoch  26/100 | Train Loss: 1.8459 Acc: 0.2134 | Val Loss: 1.9105 Acc: 0.3443 F1: 0.1553 | LR: 8.42e-04
2025-12-14 08:14:52 | INFO     |   -> New best model saved (F1: 0.1553)
2025-12-14 08:14:52 | INFO     | Epoch  27/100 | Train Loss: 1.8405 Acc: 0.2904 | Val Loss: 1.8797 Acc: 0.3594 F1: 0.1548 | LR: 8.31e-04
2025-12-14 08:14:52 | INFO     | Epoch  28/100 | Train Loss: 1.8520 Acc: 0.2457 | Val Loss: 1.8998 Acc: 0.2270 F1: 0.1235 | LR: 8.19e-04
2025-12-14 08:14:52 | INFO     | Epoch  29/100 | Train Loss: 1.8436 Acc: 0.2913 | Val Loss: 1.8729 Acc: 0.4000 F1: 0.1734 | LR: 8.07e-04
2025-12-14 08:14:52 | INFO     |   -> New best model saved (F1: 0.1734)
2025-12-14 08:14:53 | INFO     | Epoch  30/100 | Train Loss: 1.8316 Acc: 0.3181 | Val Loss: 1.8542 Acc: 0.2261 F1: 0.1583 | LR: 7.94e-04
2025-12-14 08:14:53 | INFO     | Epoch  31/100 | Train Loss: 1.8013 Acc: 0.3212 | Val Loss: 1.8659 Acc: 0.4225 F1: 0.1639 | LR: 7.81e-04
2025-12-14 08:14:53 | INFO     | Epoch  32/100 | Train Loss: 1.7757 Acc: 0.2479 | Val Loss: 1.8519 Acc: 0.2150 F1: 0.1521 | LR: 7.68e-04
2025-12-14 08:14:53 | INFO     | Epoch  33/100 | Train Loss: 1.7809 Acc: 0.3152 | Val Loss: 1.8166 Acc: 0.2856 F1: 0.1634 | LR: 7.55e-04
2025-12-14 08:14:54 | INFO     | Epoch  34/100 | Train Loss: 1.7408 Acc: 0.2379 | Val Loss: 1.8020 Acc: 0.2092 F1: 0.1328 | LR: 7.41e-04
2025-12-14 08:14:54 | INFO     | Epoch  35/100 | Train Loss: 1.7186 Acc: 0.2807 | Val Loss: 1.8198 Acc: 0.2589 F1: 0.1613 | LR: 7.27e-04
2025-12-14 08:14:54 | INFO     | Epoch  36/100 | Train Loss: 1.7480 Acc: 0.2665 | Val Loss: 1.7991 Acc: 0.2347 F1: 0.1625 | LR: 7.13e-04
2025-12-14 08:14:54 | INFO     | Epoch  37/100 | Train Loss: 1.6745 Acc: 0.2801 | Val Loss: 1.7720 Acc: 0.2004 F1: 0.1616 | LR: 6.99e-04
2025-12-14 08:14:55 | INFO     | Epoch  38/100 | Train Loss: 1.7240 Acc: 0.2372 | Val Loss: 1.8180 Acc: 0.2147 F1: 0.1408 | LR: 6.84e-04
2025-12-14 08:14:55 | INFO     | Epoch  39/100 | Train Loss: 1.6859 Acc: 0.2799 | Val Loss: 1.7615 Acc: 0.2818 F1: 0.1768 | LR: 6.70e-04
2025-12-14 08:14:55 | INFO     |   -> New best model saved (F1: 0.1768)
2025-12-14 08:14:55 | INFO     | Epoch  40/100 | Train Loss: 1.6937 Acc: 0.3524 | Val Loss: 1.7403 Acc: 0.2467 F1: 0.1807 | LR: 6.55e-04
2025-12-14 08:14:55 | INFO     |   -> New best model saved (F1: 0.1807)
2025-12-14 08:14:56 | INFO     | Epoch  41/100 | Train Loss: 1.6533 Acc: 0.2464 | Val Loss: 1.7264 Acc: 0.2324 F1: 0.1750 | LR: 6.40e-04
2025-12-14 08:14:56 | INFO     | Epoch  42/100 | Train Loss: 1.6522 Acc: 0.2921 | Val Loss: 1.7949 Acc: 0.2652 F1: 0.2001 | LR: 6.25e-04
2025-12-14 08:14:56 | INFO     |   -> New best model saved (F1: 0.2001)
2025-12-14 08:14:56 | INFO     | Epoch  43/100 | Train Loss: 1.6407 Acc: 0.2978 | Val Loss: 1.7204 Acc: 0.3157 F1: 0.2469 | LR: 6.09e-04
2025-12-14 08:14:56 | INFO     |   -> New best model saved (F1: 0.2469)
2025-12-14 08:14:56 | INFO     | Epoch  44/100 | Train Loss: 1.6015 Acc: 0.3017 | Val Loss: 1.6962 Acc: 0.2793 F1: 0.2288 | LR: 5.94e-04
2025-12-14 08:14:57 | INFO     | Epoch  45/100 | Train Loss: 1.6500 Acc: 0.3173 | Val Loss: 1.6677 Acc: 0.2872 F1: 0.2213 | LR: 5.79e-04
2025-12-14 08:14:57 | INFO     | Epoch  46/100 | Train Loss: 1.5753 Acc: 0.3588 | Val Loss: 1.6243 Acc: 0.3105 F1: 0.2463 | LR: 5.63e-04
2025-12-14 08:14:57 | INFO     | Epoch  47/100 | Train Loss: 1.5640 Acc: 0.3196 | Val Loss: 1.7302 Acc: 0.3462 F1: 0.2104 | LR: 5.48e-04
2025-12-14 08:14:57 | INFO     | Epoch  48/100 | Train Loss: 1.5598 Acc: 0.3305 | Val Loss: 1.6350 Acc: 0.2333 F1: 0.1942 | LR: 5.32e-04
2025-12-14 08:14:58 | INFO     | Epoch  49/100 | Train Loss: 1.5875 Acc: 0.3289 | Val Loss: 1.5687 Acc: 0.3222 F1: 0.2502 | LR: 5.16e-04
2025-12-14 08:14:58 | INFO     |   -> New best model saved (F1: 0.2502)
2025-12-14 08:14:58 | INFO     | Epoch  50/100 | Train Loss: 1.5061 Acc: 0.3790 | Val Loss: 1.6011 Acc: 0.3590 F1: 0.2419 | LR: 5.01e-04
2025-12-14 08:14:58 | INFO     | Epoch  51/100 | Train Loss: 1.5325 Acc: 0.3704 | Val Loss: 1.5851 Acc: 0.3486 F1: 0.2506 | LR: 4.85e-04
2025-12-14 08:14:58 | INFO     |   -> New best model saved (F1: 0.2506)
2025-12-14 08:14:58 | INFO     | Epoch  52/100 | Train Loss: 1.4697 Acc: 0.4055 | Val Loss: 1.5648 Acc: 0.3773 F1: 0.2668 | LR: 4.69e-04
2025-12-14 08:14:58 | INFO     |   -> New best model saved (F1: 0.2668)
2025-12-14 08:14:59 | INFO     | Epoch  53/100 | Train Loss: 1.4889 Acc: 0.3869 | Val Loss: 1.6955 Acc: 0.3559 F1: 0.2472 | LR: 4.53e-04
2025-12-14 08:14:59 | INFO     | Epoch  54/100 | Train Loss: 1.4958 Acc: 0.4018 | Val Loss: 1.5420 Acc: 0.3373 F1: 0.2734 | LR: 4.38e-04
2025-12-14 08:14:59 | INFO     |   -> New best model saved (F1: 0.2734)
2025-12-14 08:14:59 | INFO     | Epoch  55/100 | Train Loss: 1.4552 Acc: 0.3922 | Val Loss: 1.5011 Acc: 0.3686 F1: 0.2877 | LR: 4.22e-04
2025-12-14 08:14:59 | INFO     |   -> New best model saved (F1: 0.2877)
2025-12-14 08:14:59 | INFO     | Epoch  56/100 | Train Loss: 1.4494 Acc: 0.3827 | Val Loss: 1.4867 Acc: 0.3493 F1: 0.2824 | LR: 4.07e-04
2025-12-14 08:15:00 | INFO     | Epoch  57/100 | Train Loss: 1.4688 Acc: 0.4047 | Val Loss: 1.5249 Acc: 0.3363 F1: 0.2894 | LR: 3.92e-04
2025-12-14 08:15:00 | INFO     |   -> New best model saved (F1: 0.2894)
2025-12-14 08:15:00 | INFO     | Epoch  58/100 | Train Loss: 1.4182 Acc: 0.3890 | Val Loss: 1.5014 Acc: 0.3377 F1: 0.2875 | LR: 3.76e-04
2025-12-14 08:15:00 | INFO     | Epoch  59/100 | Train Loss: 1.3718 Acc: 0.4259 | Val Loss: 1.4735 Acc: 0.3555 F1: 0.2944 | LR: 3.61e-04
2025-12-14 08:15:00 | INFO     |   -> New best model saved (F1: 0.2944)
2025-12-14 08:15:00 | INFO     | Epoch  60/100 | Train Loss: 1.3888 Acc: 0.3942 | Val Loss: 1.4934 Acc: 0.3626 F1: 0.2915 | LR: 3.46e-04
2025-12-14 08:15:01 | INFO     | Epoch  61/100 | Train Loss: 1.3806 Acc: 0.3988 | Val Loss: 1.4501 Acc: 0.3562 F1: 0.2948 | LR: 3.31e-04
2025-12-14 08:15:01 | INFO     |   -> New best model saved (F1: 0.2948)
2025-12-14 08:15:01 | INFO     | Epoch  62/100 | Train Loss: 1.3647 Acc: 0.3991 | Val Loss: 1.4498 Acc: 0.3504 F1: 0.2983 | LR: 3.17e-04
2025-12-14 08:15:01 | INFO     |   -> New best model saved (F1: 0.2983)
2025-12-14 08:15:01 | INFO     | Epoch  63/100 | Train Loss: 1.3453 Acc: 0.4035 | Val Loss: 1.4423 Acc: 0.3636 F1: 0.3045 | LR: 3.02e-04
2025-12-14 08:15:01 | INFO     |   -> New best model saved (F1: 0.3045)
2025-12-14 08:15:01 | INFO     | Epoch  64/100 | Train Loss: 1.3285 Acc: 0.4324 | Val Loss: 1.4248 Acc: 0.3836 F1: 0.3075 | LR: 2.88e-04
2025-12-14 08:15:01 | INFO     |   -> New best model saved (F1: 0.3075)
2025-12-14 08:15:01 | INFO     | Epoch  65/100 | Train Loss: 1.3341 Acc: 0.4455 | Val Loss: 1.4300 Acc: 0.3457 F1: 0.3037 | LR: 2.74e-04
2025-12-14 08:15:02 | INFO     | Epoch  66/100 | Train Loss: 1.2944 Acc: 0.4392 | Val Loss: 1.4371 Acc: 0.3911 F1: 0.3185 | LR: 2.60e-04
2025-12-14 08:15:02 | INFO     |   -> New best model saved (F1: 0.3185)
2025-12-14 08:15:02 | INFO     | Epoch  67/100 | Train Loss: 1.2836 Acc: 0.4425 | Val Loss: 1.3965 Acc: 0.3757 F1: 0.3206 | LR: 2.46e-04
2025-12-14 08:15:02 | INFO     |   -> New best model saved (F1: 0.3206)
2025-12-14 08:15:02 | INFO     | Epoch  68/100 | Train Loss: 1.2791 Acc: 0.4408 | Val Loss: 1.3988 Acc: 0.4017 F1: 0.3231 | LR: 2.33e-04
2025-12-14 08:15:02 | INFO     |   -> New best model saved (F1: 0.3231)
2025-12-14 08:15:02 | INFO     | Epoch  69/100 | Train Loss: 1.2475 Acc: 0.4413 | Val Loss: 1.4335 Acc: 0.3712 F1: 0.3139 | LR: 2.20e-04
2025-12-14 08:15:03 | INFO     | Epoch  70/100 | Train Loss: 1.2499 Acc: 0.4435 | Val Loss: 1.3984 Acc: 0.3946 F1: 0.3333 | LR: 2.07e-04
2025-12-14 08:15:03 | INFO     |   -> New best model saved (F1: 0.3333)
2025-12-14 08:15:03 | INFO     | Epoch  71/100 | Train Loss: 1.2388 Acc: 0.4643 | Val Loss: 1.4069 Acc: 0.4015 F1: 0.3370 | LR: 1.94e-04
2025-12-14 08:15:03 | INFO     |   -> New best model saved (F1: 0.3370)
2025-12-14 08:15:03 | INFO     | Epoch  72/100 | Train Loss: 1.2230 Acc: 0.4719 | Val Loss: 1.4007 Acc: 0.4091 F1: 0.3330 | LR: 1.82e-04
2025-12-14 08:15:03 | INFO     | Epoch  73/100 | Train Loss: 1.2203 Acc: 0.4596 | Val Loss: 1.3910 Acc: 0.4257 F1: 0.3542 | LR: 1.70e-04
2025-12-14 08:15:03 | INFO     |   -> New best model saved (F1: 0.3542)
2025-12-14 08:15:04 | INFO     | Epoch  74/100 | Train Loss: 1.1993 Acc: 0.4785 | Val Loss: 1.3912 Acc: 0.4251 F1: 0.3539 | LR: 1.59e-04
2025-12-14 08:15:04 | INFO     | Epoch  75/100 | Train Loss: 1.1870 Acc: 0.5032 | Val Loss: 1.3722 Acc: 0.4191 F1: 0.3718 | LR: 1.47e-04
2025-12-14 08:15:04 | INFO     |   -> New best model saved (F1: 0.3718)
2025-12-14 08:15:04 | INFO     | Epoch  76/100 | Train Loss: 1.1926 Acc: 0.4683 | Val Loss: 1.3939 Acc: 0.4077 F1: 0.3628 | LR: 1.36e-04
2025-12-14 08:15:04 | INFO     | Epoch  77/100 | Train Loss: 1.1954 Acc: 0.4768 | Val Loss: 1.3748 Acc: 0.4409 F1: 0.3780 | LR: 1.26e-04
2025-12-14 08:15:04 | INFO     |   -> New best model saved (F1: 0.3780)
2025-12-14 08:15:05 | INFO     | Epoch  78/100 | Train Loss: 1.1633 Acc: 0.4900 | Val Loss: 1.3931 Acc: 0.4345 F1: 0.3652 | LR: 1.16e-04
2025-12-14 08:15:05 | INFO     | Epoch  79/100 | Train Loss: 1.1655 Acc: 0.5014 | Val Loss: 1.4024 Acc: 0.4456 F1: 0.3747 | LR: 1.06e-04
2025-12-14 08:15:05 | INFO     | Epoch  80/100 | Train Loss: 1.1334 Acc: 0.5090 | Val Loss: 1.4122 Acc: 0.4524 F1: 0.3731 | LR: 9.64e-05
2025-12-14 08:15:05 | INFO     | Epoch  81/100 | Train Loss: 1.1289 Acc: 0.5099 | Val Loss: 1.3549 Acc: 0.4531 F1: 0.3861 | LR: 8.74e-05
2025-12-14 08:15:05 | INFO     |   -> New best model saved (F1: 0.3861)
2025-12-14 08:15:06 | INFO     | Epoch  82/100 | Train Loss: 1.1354 Acc: 0.5088 | Val Loss: 1.3946 Acc: 0.4545 F1: 0.3787 | LR: 7.88e-05
2025-12-14 08:15:06 | INFO     | Epoch  83/100 | Train Loss: 1.1171 Acc: 0.5206 | Val Loss: 1.4137 Acc: 0.4564 F1: 0.3805 | LR: 7.06e-05
2025-12-14 08:15:06 | INFO     | Epoch  84/100 | Train Loss: 1.1166 Acc: 0.5242 | Val Loss: 1.3927 Acc: 0.4676 F1: 0.3803 | LR: 6.28e-05
2025-12-14 08:15:06 | INFO     | Epoch  85/100 | Train Loss: 1.0960 Acc: 0.5212 | Val Loss: 1.3924 Acc: 0.4585 F1: 0.3803 | LR: 5.54e-05
2025-12-14 08:15:07 | INFO     | Epoch  86/100 | Train Loss: 1.1052 Acc: 0.5286 | Val Loss: 1.3972 Acc: 0.4616 F1: 0.3703 | LR: 4.85e-05
2025-12-14 08:15:07 | INFO     | Epoch  87/100 | Train Loss: 1.0837 Acc: 0.5256 | Val Loss: 1.3756 Acc: 0.4640 F1: 0.3824 | LR: 4.21e-05
2025-12-14 08:15:07 | INFO     | Epoch  88/100 | Train Loss: 1.0811 Acc: 0.5354 | Val Loss: 1.3895 Acc: 0.4708 F1: 0.3856 | LR: 3.61e-05
2025-12-14 08:15:07 | INFO     | Epoch  89/100 | Train Loss: 1.0893 Acc: 0.5353 | Val Loss: 1.3867 Acc: 0.4689 F1: 0.3796 | LR: 3.05e-05
2025-12-14 08:15:08 | INFO     | Epoch  90/100 | Train Loss: 1.0973 Acc: 0.5353 | Val Loss: 1.3751 Acc: 0.4674 F1: 0.3830 | LR: 2.54e-05
2025-12-14 08:15:08 | INFO     | Epoch  91/100 | Train Loss: 1.0916 Acc: 0.5311 | Val Loss: 1.3782 Acc: 0.4715 F1: 0.3870 | LR: 2.08e-05
2025-12-14 08:15:08 | INFO     |   -> New best model saved (F1: 0.3870)
2025-12-14 08:15:08 | INFO     | Epoch  92/100 | Train Loss: 1.0686 Acc: 0.5366 | Val Loss: 1.3772 Acc: 0.4663 F1: 0.3833 | LR: 1.67e-05
2025-12-14 08:15:08 | INFO     | Epoch  93/100 | Train Loss: 1.0685 Acc: 0.5398 | Val Loss: 1.3733 Acc: 0.4696 F1: 0.3911 | LR: 1.30e-05
2025-12-14 08:15:08 | INFO     |   -> New best model saved (F1: 0.3911)
2025-12-14 08:15:09 | INFO     | Epoch  94/100 | Train Loss: 1.0765 Acc: 0.5376 | Val Loss: 1.3718 Acc: 0.4715 F1: 0.3933 | LR: 9.85e-06
2025-12-14 08:15:09 | INFO     |   -> New best model saved (F1: 0.3933)
2025-12-14 08:15:09 | INFO     | Epoch  95/100 | Train Loss: 1.0659 Acc: 0.5412 | Val Loss: 1.3839 Acc: 0.4691 F1: 0.3795 | LR: 7.15e-06
2025-12-14 08:15:09 | INFO     | Epoch  96/100 | Train Loss: 1.0741 Acc: 0.5417 | Val Loss: 1.3822 Acc: 0.4674 F1: 0.3794 | LR: 4.94e-06
2025-12-14 08:15:10 | INFO     | Epoch  97/100 | Train Loss: 1.0587 Acc: 0.5422 | Val Loss: 1.3778 Acc: 0.4680 F1: 0.3837 | LR: 3.22e-06
2025-12-14 08:15:10 | INFO     | Epoch  98/100 | Train Loss: 1.0722 Acc: 0.5412 | Val Loss: 1.3694 Acc: 0.4742 F1: 0.3940 | LR: 1.99e-06
2025-12-14 08:15:10 | INFO     |   -> New best model saved (F1: 0.3940)
2025-12-14 08:15:10 | INFO     | Epoch  99/100 | Train Loss: 1.0541 Acc: 0.5456 | Val Loss: 1.3694 Acc: 0.4744 F1: 0.3947 | LR: 1.25e-06
2025-12-14 08:15:10 | INFO     |   -> New best model saved (F1: 0.3947)
2025-12-14 08:15:10 | INFO     | Epoch 100/100 | Train Loss: 1.0627 Acc: 0.5432 | Val Loss: 1.3696 Acc: 0.4740 F1: 0.3942 | LR: 1.00e-06
2025-12-14 08:15:10 | INFO     | ============================================================
2025-12-14 08:15:10 | INFO     | EVALUATING BEST MODEL ON TEST SET
2025-12-14 08:15:10 | INFO     | ============================================================
2025-12-14 08:15:11 | INFO     | 
Test Loss: 1.4278
2025-12-14 08:15:11 | INFO     | Test Accuracy: 0.4662
2025-12-14 08:15:11 | INFO     | ============================================================
SEQUENCE LABELING METRICS
============================================================

Standard Metrics:
  Accuracy:         0.4662
  F1 (micro):       0.4662
  F1 (macro):       0.2897
  F1 (weighted):    0.5270

Pattern Detection Metrics:
  Coverage Score:   0.3859
  Detection Rate:   0.8796
  False Alarm Rate: 0.4834
  Boundary Acc:     0.2176

Pattern-Level Metrics:
  Pattern Precision: 0.0663
  Pattern Recall:    0.2222
  Pattern F1:        0.1021

ROC-AUC (macro):     0.8009

Per-Class F1:
  None                : 0.6293
  Bearish Normal      : 0.1167
  Bearish Wedge       : 0.0738
  Bearish Pennant     : 0.1025
  Bullish Normal      : 0.0874
  Bullish Wedge       : 0.3414
  Bullish Pennant     : 0.6766
============================================================
2025-12-14 08:15:11 | INFO     | ============================================================
2025-12-14 08:15:11 | INFO     | TRAINING COMPLETE
2025-12-14 08:15:11 | INFO     | ============================================================
