2025-12-14 08:34:49 | INFO     | Model: seq_lstm
2025-12-14 08:34:49 | INFO     | Mode: 7class (7 classes)
2025-12-14 08:34:49 | INFO     | Data dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/data
2025-12-14 08:34:49 | INFO     | Save dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/models/seq_lstm
2025-12-14 08:34:49 | INFO     | Device: cuda
2025-12-14 08:34:49 | INFO     | Loaded pre-split data:
2025-12-14 08:34:49 | INFO     |   Train: (481, 256, 4) (may be augmented)
2025-12-14 08:34:49 | INFO     |   Val:   (42, 256, 4) (original)
2025-12-14 08:34:49 | INFO     |   Test:  (42, 256, 4) (original)
2025-12-14 08:34:49 | INFO     | Class names: ['None', 'Bearish Normal', 'Bearish Wedge', 'Bearish Pennant', 'Bullish Normal', 'Bullish Wedge', 'Bullish Pennant']
2025-12-14 08:34:49 | INFO     | Balanced: True
2025-12-14 08:34:49 | INFO     | Training label distribution:
2025-12-14 08:34:49 | INFO     |   None: 78455 (63.7%)
2025-12-14 08:34:49 | INFO     |   Bearish Normal: 4441 (3.6%)
2025-12-14 08:34:49 | INFO     |   Bearish Wedge: 7151 (5.8%)
2025-12-14 08:34:49 | INFO     |   Bearish Pennant: 10787 (8.8%)
2025-12-14 08:34:49 | INFO     |   Bullish Normal: 5816 (4.7%)
2025-12-14 08:34:49 | INFO     |   Bullish Wedge: 7670 (6.2%)
2025-12-14 08:34:49 | INFO     |   Bullish Pennant: 8816 (7.2%)
2025-12-14 08:34:49 | INFO     | Config: {'input_size': 4, 'hidden_size': 128, 'num_layers': 2, 'num_classes': 7, 'dropout': 0.2, 'bidirectional': False, 'learning_rate': 0.0005, 'batch_size': 16, 'epochs': 300, 'weight_decay': 1e-05, 'use_class_weights': True, 'max_class_weight': 10.0, 'patience': 50, 'min_delta': 0.0001, 'scheduler': 'cosine', 'warmup_epochs': 5, 'label_smoothing': 0.05, 'focal_loss': False, 'focal_gamma': 2.0, 'name': 'seq_lstm_7class', 'description': '7-class LSTM: detailed pattern type classification', 'mode': '7class'}
2025-12-14 08:34:49 | INFO     | Train: 481 samples
2025-12-14 08:34:49 | INFO     | Val:   42 samples
2025-12-14 08:34:49 | INFO     | Test:  42 samples
2025-12-14 08:34:49 | INFO     | Class weights (balanced): [0.12243697792291641, 1.224369764328003, 1.224369764328003, 0.8904972076416016, 1.224369764328003, 1.224369764328003, 1.0895862579345703]
2025-12-14 08:34:49 | INFO     | Model parameters: 201,607
2025-12-14 08:34:50 | INFO     | ============================================================
2025-12-14 08:34:50 | INFO     | TRAINING STARTED
2025-12-14 08:34:50 | INFO     | ============================================================
2025-12-14 08:34:51 | INFO     | Epoch   1/300 | Train Loss: 1.9918 Acc: 0.2054 | Val Loss: 2.1478 Acc: 0.2791 F1: 0.0950 | LR: 5.00e-04
2025-12-14 08:34:51 | INFO     |   -> New best model saved (F1: 0.0950)
2025-12-14 08:34:51 | INFO     | Epoch   2/300 | Train Loss: 1.9444 Acc: 0.2481 | Val Loss: 1.9343 Acc: 0.5139 F1: 0.1184 | LR: 5.00e-04
2025-12-14 08:34:51 | INFO     |   -> New best model saved (F1: 0.1184)
2025-12-14 08:34:51 | INFO     | Epoch   3/300 | Train Loss: 1.9211 Acc: 0.2317 | Val Loss: 2.0578 Acc: 0.1807 F1: 0.0821 | LR: 5.00e-04
2025-12-14 08:34:51 | INFO     | Epoch   4/300 | Train Loss: 1.9492 Acc: 0.2847 | Val Loss: 2.0521 Acc: 0.2009 F1: 0.0651 | LR: 5.00e-04
2025-12-14 08:34:51 | INFO     | Epoch   5/300 | Train Loss: 1.9063 Acc: 0.2545 | Val Loss: 2.0597 Acc: 0.2057 F1: 0.0827 | LR: 5.00e-04
2025-12-14 08:34:51 | INFO     | Epoch   6/300 | Train Loss: 1.9115 Acc: 0.3427 | Val Loss: 1.9644 Acc: 0.1520 F1: 0.0530 | LR: 5.00e-04
2025-12-14 08:34:52 | INFO     | Epoch   7/300 | Train Loss: 1.8955 Acc: 0.2769 | Val Loss: 1.9436 Acc: 0.2763 F1: 0.1027 | LR: 4.99e-04
2025-12-14 08:34:52 | INFO     | Epoch   8/300 | Train Loss: 1.8839 Acc: 0.3259 | Val Loss: 1.9327 Acc: 0.2414 F1: 0.1182 | LR: 4.99e-04
2025-12-14 08:34:52 | INFO     | Epoch   9/300 | Train Loss: 1.8787 Acc: 0.2825 | Val Loss: 2.0650 Acc: 0.5206 F1: 0.1251 | LR: 4.99e-04
2025-12-14 08:34:52 | INFO     |   -> New best model saved (F1: 0.1251)
2025-12-14 08:34:52 | INFO     | Epoch  10/300 | Train Loss: 1.8742 Acc: 0.3417 | Val Loss: 1.9346 Acc: 0.2557 F1: 0.1144 | LR: 4.99e-04
2025-12-14 08:34:52 | INFO     | Epoch  11/300 | Train Loss: 1.8619 Acc: 0.3391 | Val Loss: 1.9069 Acc: 0.4243 F1: 0.1461 | LR: 4.98e-04
2025-12-14 08:34:52 | INFO     |   -> New best model saved (F1: 0.1461)
2025-12-14 08:34:52 | INFO     | Epoch  12/300 | Train Loss: 1.8239 Acc: 0.3800 | Val Loss: 1.9022 Acc: 0.4528 F1: 0.1458 | LR: 4.98e-04
2025-12-14 08:34:53 | INFO     | Epoch  13/300 | Train Loss: 1.8060 Acc: 0.4066 | Val Loss: 1.8516 Acc: 0.4614 F1: 0.1555 | LR: 4.98e-04
2025-12-14 08:34:53 | INFO     |   -> New best model saved (F1: 0.1555)
2025-12-14 08:34:53 | INFO     | Epoch  14/300 | Train Loss: 1.8216 Acc: 0.3922 | Val Loss: 1.9180 Acc: 0.3715 F1: 0.1372 | LR: 4.97e-04
2025-12-14 08:34:53 | INFO     | Epoch  15/300 | Train Loss: 1.8531 Acc: 0.3168 | Val Loss: 1.8531 Acc: 0.4202 F1: 0.1678 | LR: 4.97e-04
2025-12-14 08:34:53 | INFO     |   -> New best model saved (F1: 0.1678)
2025-12-14 08:34:53 | INFO     | Epoch  16/300 | Train Loss: 1.7836 Acc: 0.3505 | Val Loss: 1.8321 Acc: 0.4070 F1: 0.1525 | LR: 4.97e-04
2025-12-14 08:34:53 | INFO     | Epoch  17/300 | Train Loss: 1.7764 Acc: 0.3832 | Val Loss: 1.8594 Acc: 0.4641 F1: 0.1591 | LR: 4.96e-04
2025-12-14 08:34:53 | INFO     | Epoch  18/300 | Train Loss: 1.7535 Acc: 0.4010 | Val Loss: 1.8969 Acc: 0.4545 F1: 0.1747 | LR: 4.96e-04
2025-12-14 08:34:53 | INFO     |   -> New best model saved (F1: 0.1747)
2025-12-14 08:34:54 | INFO     | Epoch  19/300 | Train Loss: 1.7303 Acc: 0.4285 | Val Loss: 1.7899 Acc: 0.4867 F1: 0.2382 | LR: 4.95e-04
2025-12-14 08:34:54 | INFO     |   -> New best model saved (F1: 0.2382)
2025-12-14 08:34:54 | INFO     | Epoch  20/300 | Train Loss: 1.7183 Acc: 0.4027 | Val Loss: 1.7748 Acc: 0.4274 F1: 0.1593 | LR: 4.95e-04
2025-12-14 08:34:54 | INFO     | Epoch  21/300 | Train Loss: 1.6981 Acc: 0.4036 | Val Loss: 1.8027 Acc: 0.4759 F1: 0.1972 | LR: 4.94e-04
2025-12-14 08:34:54 | INFO     | Epoch  22/300 | Train Loss: 1.6965 Acc: 0.3705 | Val Loss: 1.7978 Acc: 0.5020 F1: 0.2020 | LR: 4.93e-04
2025-12-14 08:34:54 | INFO     | Epoch  23/300 | Train Loss: 1.6785 Acc: 0.4042 | Val Loss: 1.7947 Acc: 0.4897 F1: 0.1932 | LR: 4.93e-04
2025-12-14 08:34:54 | INFO     | Epoch  24/300 | Train Loss: 1.6708 Acc: 0.4268 | Val Loss: 1.7284 Acc: 0.4575 F1: 0.1796 | LR: 4.92e-04
2025-12-14 08:34:55 | INFO     | Epoch  25/300 | Train Loss: 1.6533 Acc: 0.4130 | Val Loss: 1.7703 Acc: 0.4965 F1: 0.1992 | LR: 4.91e-04
2025-12-14 08:34:55 | INFO     | Epoch  26/300 | Train Loss: 1.6977 Acc: 0.4560 | Val Loss: 1.7667 Acc: 0.4858 F1: 0.1884 | LR: 4.91e-04
2025-12-14 08:34:55 | INFO     | Epoch  27/300 | Train Loss: 1.6709 Acc: 0.3611 | Val Loss: 1.7877 Acc: 0.4251 F1: 0.2108 | LR: 4.90e-04
2025-12-14 08:34:55 | INFO     | Epoch  28/300 | Train Loss: 1.6215 Acc: 0.4280 | Val Loss: 1.8016 Acc: 0.3551 F1: 0.1557 | LR: 4.89e-04
2025-12-14 08:34:55 | INFO     | Epoch  29/300 | Train Loss: 1.6304 Acc: 0.4094 | Val Loss: 1.7262 Acc: 0.4710 F1: 0.2038 | LR: 4.89e-04
2025-12-14 08:34:56 | INFO     | Epoch  30/300 | Train Loss: 1.5795 Acc: 0.4092 | Val Loss: 1.7937 Acc: 0.3613 F1: 0.1629 | LR: 4.88e-04
2025-12-14 08:34:56 | INFO     | Epoch  31/300 | Train Loss: 1.5534 Acc: 0.4056 | Val Loss: 1.7325 Acc: 0.4721 F1: 0.2156 | LR: 4.87e-04
2025-12-14 08:34:56 | INFO     | Epoch  32/300 | Train Loss: 1.6380 Acc: 0.3905 | Val Loss: 1.7852 Acc: 0.3846 F1: 0.1845 | LR: 4.86e-04
2025-12-14 08:34:56 | INFO     | Epoch  33/300 | Train Loss: 1.5923 Acc: 0.4101 | Val Loss: 1.9218 Acc: 0.3714 F1: 0.1718 | LR: 4.85e-04
2025-12-14 08:34:56 | INFO     | Epoch  34/300 | Train Loss: 1.5617 Acc: 0.4471 | Val Loss: 1.7494 Acc: 0.5105 F1: 0.2144 | LR: 4.84e-04
2025-12-14 08:34:56 | INFO     | Epoch  35/300 | Train Loss: 1.5232 Acc: 0.4288 | Val Loss: 1.7270 Acc: 0.4914 F1: 0.1757 | LR: 4.83e-04
2025-12-14 08:34:57 | INFO     | Epoch  36/300 | Train Loss: 1.5071 Acc: 0.4427 | Val Loss: 1.7578 Acc: 0.4891 F1: 0.1972 | LR: 4.82e-04
2025-12-14 08:34:57 | INFO     | Epoch  37/300 | Train Loss: 1.5070 Acc: 0.4766 | Val Loss: 1.7268 Acc: 0.4366 F1: 0.2287 | LR: 4.82e-04
2025-12-14 08:34:57 | INFO     | Epoch  38/300 | Train Loss: 1.4698 Acc: 0.4499 | Val Loss: 1.7623 Acc: 0.4191 F1: 0.1675 | LR: 4.81e-04
2025-12-14 08:34:57 | INFO     | Epoch  39/300 | Train Loss: 1.4675 Acc: 0.4708 | Val Loss: 1.7519 Acc: 0.4048 F1: 0.1669 | LR: 4.79e-04
2025-12-14 08:34:57 | INFO     | Epoch  40/300 | Train Loss: 1.5548 Acc: 0.4063 | Val Loss: 1.7411 Acc: 0.5815 F1: 0.1971 | LR: 4.78e-04
2025-12-14 08:34:58 | INFO     | Epoch  41/300 | Train Loss: 1.5003 Acc: 0.4757 | Val Loss: 1.8371 Acc: 0.4042 F1: 0.1783 | LR: 4.77e-04
2025-12-14 08:34:58 | INFO     | Epoch  42/300 | Train Loss: 1.4699 Acc: 0.4667 | Val Loss: 1.7230 Acc: 0.4422 F1: 0.1746 | LR: 4.76e-04
2025-12-14 08:34:58 | INFO     | Epoch  43/300 | Train Loss: 1.4817 Acc: 0.4818 | Val Loss: 1.7653 Acc: 0.4269 F1: 0.1797 | LR: 4.75e-04
2025-12-14 08:34:58 | INFO     | Epoch  44/300 | Train Loss: 1.4009 Acc: 0.4926 | Val Loss: 1.8210 Acc: 0.5139 F1: 0.1971 | LR: 4.74e-04
2025-12-14 08:34:58 | INFO     | Epoch  45/300 | Train Loss: 1.4258 Acc: 0.4618 | Val Loss: 1.8011 Acc: 0.5389 F1: 0.1928 | LR: 4.73e-04
2025-12-14 08:34:58 | INFO     | Epoch  46/300 | Train Loss: 1.3983 Acc: 0.5154 | Val Loss: 1.8311 Acc: 0.3793 F1: 0.1495 | LR: 4.72e-04
2025-12-14 08:34:59 | INFO     | Epoch  47/300 | Train Loss: 1.3746 Acc: 0.4650 | Val Loss: 1.7763 Acc: 0.4364 F1: 0.1869 | LR: 4.70e-04
2025-12-14 08:34:59 | INFO     | Epoch  48/300 | Train Loss: 1.3716 Acc: 0.5251 | Val Loss: 1.7811 Acc: 0.3691 F1: 0.1443 | LR: 4.69e-04
2025-12-14 08:34:59 | INFO     | Epoch  49/300 | Train Loss: 1.4021 Acc: 0.5127 | Val Loss: 1.8657 Acc: 0.3732 F1: 0.1666 | LR: 4.68e-04
2025-12-14 08:34:59 | INFO     | Epoch  50/300 | Train Loss: 1.3360 Acc: 0.4824 | Val Loss: 1.7602 Acc: 0.5282 F1: 0.1951 | LR: 4.67e-04
2025-12-14 08:34:59 | INFO     | Epoch  51/300 | Train Loss: 1.3179 Acc: 0.5070 | Val Loss: 1.7861 Acc: 0.4947 F1: 0.1895 | LR: 4.65e-04
2025-12-14 08:34:59 | INFO     | Epoch  52/300 | Train Loss: 1.3253 Acc: 0.5047 | Val Loss: 1.7822 Acc: 0.3590 F1: 0.1431 | LR: 4.64e-04
2025-12-14 08:35:00 | INFO     | Epoch  53/300 | Train Loss: 1.3076 Acc: 0.4946 | Val Loss: 1.8139 Acc: 0.3567 F1: 0.1593 | LR: 4.63e-04
2025-12-14 08:35:00 | INFO     | Epoch  54/300 | Train Loss: 1.2925 Acc: 0.4742 | Val Loss: 1.8683 Acc: 0.5276 F1: 0.1939 | LR: 4.61e-04
2025-12-14 08:35:00 | INFO     | Epoch  55/300 | Train Loss: 1.2393 Acc: 0.5264 | Val Loss: 2.0097 Acc: 0.4244 F1: 0.1698 | LR: 4.60e-04
2025-12-14 08:35:00 | INFO     | Epoch  56/300 | Train Loss: 1.2351 Acc: 0.5269 | Val Loss: 1.9529 Acc: 0.5140 F1: 0.2000 | LR: 4.58e-04
2025-12-14 08:35:00 | INFO     | Epoch  57/300 | Train Loss: 1.3134 Acc: 0.5426 | Val Loss: 1.8193 Acc: 0.4483 F1: 0.1943 | LR: 4.57e-04
2025-12-14 08:35:00 | INFO     | Epoch  58/300 | Train Loss: 1.3029 Acc: 0.4999 | Val Loss: 2.0216 Acc: 0.4952 F1: 0.1865 | LR: 4.55e-04
2025-12-14 08:35:01 | INFO     | Epoch  59/300 | Train Loss: 1.2802 Acc: 0.4993 | Val Loss: 2.0663 Acc: 0.3919 F1: 0.1660 | LR: 4.54e-04
2025-12-14 08:35:01 | INFO     | Epoch  60/300 | Train Loss: 1.3135 Acc: 0.4880 | Val Loss: 2.0092 Acc: 0.5034 F1: 0.1816 | LR: 4.52e-04
2025-12-14 08:35:01 | INFO     | Epoch  61/300 | Train Loss: 1.1693 Acc: 0.5600 | Val Loss: 1.8998 Acc: 0.5319 F1: 0.1975 | LR: 4.51e-04
2025-12-14 08:35:01 | INFO     | Epoch  62/300 | Train Loss: 1.2254 Acc: 0.5549 | Val Loss: 1.9375 Acc: 0.4369 F1: 0.1592 | LR: 4.49e-04
2025-12-14 08:35:01 | INFO     | Epoch  63/300 | Train Loss: 1.2145 Acc: 0.5398 | Val Loss: 1.8880 Acc: 0.4564 F1: 0.1693 | LR: 4.48e-04
2025-12-14 08:35:02 | INFO     | Epoch  64/300 | Train Loss: 1.1735 Acc: 0.5412 | Val Loss: 2.0398 Acc: 0.4509 F1: 0.1474 | LR: 4.46e-04
2025-12-14 08:35:02 | INFO     | Epoch  65/300 | Train Loss: 1.1702 Acc: 0.5503 | Val Loss: 2.0066 Acc: 0.4036 F1: 0.1554 | LR: 4.44e-04
2025-12-14 08:35:02 | INFO     | Epoch  66/300 | Train Loss: 1.1653 Acc: 0.5551 | Val Loss: 2.0580 Acc: 0.4630 F1: 0.1539 | LR: 4.43e-04
2025-12-14 08:35:02 | INFO     | Epoch  67/300 | Train Loss: 1.1435 Acc: 0.5591 | Val Loss: 2.2409 Acc: 0.4131 F1: 0.1592 | LR: 4.41e-04
2025-12-14 08:35:02 | INFO     | Epoch  68/300 | Train Loss: 1.1707 Acc: 0.5491 | Val Loss: 1.9853 Acc: 0.4542 F1: 0.1687 | LR: 4.39e-04
2025-12-14 08:35:02 | INFO     | Epoch  69/300 | Train Loss: 1.1327 Acc: 0.5655 | Val Loss: 2.1940 Acc: 0.3580 F1: 0.1216 | LR: 4.38e-04
2025-12-14 08:35:02 | INFO     | Early stopping at epoch 69
2025-12-14 08:35:02 | INFO     | ============================================================
2025-12-14 08:35:02 | INFO     | EVALUATING BEST MODEL ON TEST SET
2025-12-14 08:35:02 | INFO     | ============================================================
2025-12-14 08:35:03 | INFO     | 
Test Loss: 1.9068
2025-12-14 08:35:03 | INFO     | Test Accuracy: 0.4454
2025-12-14 08:35:03 | INFO     | ============================================================
SEQUENCE LABELING METRICS
============================================================

Standard Metrics:
  Accuracy:         0.4454
  F1 (micro):       0.4454
  F1 (macro):       0.1556
  F1 (weighted):    0.5291

Pattern Detection Metrics:
  Coverage Score:   0.2980
  Detection Rate:   0.9286
  False Alarm Rate: 0.3782
  Boundary Acc:     0.0714

Pattern-Level Metrics:
  Pattern Precision: 0.0336
  Pattern Recall:    0.0952
  Pattern F1:        0.0497

ROC-AUC (macro):     0.6414

Per-Class F1:
  None                : 0.6720
  Bearish Normal      : 0.2527
  Bearish Wedge       : 0.0072
  Bearish Pennant     : 0.0440
  Bullish Normal      : 0.0857
  Bullish Wedge       : 0.0000
  Bullish Pennant     : 0.0274
============================================================
2025-12-14 08:35:03 | INFO     | ============================================================
2025-12-14 08:35:03 | INFO     | TRAINING COMPLETE
2025-12-14 08:35:03 | INFO     | ============================================================
