2025-12-14 08:49:23 | INFO     | Model: seq_lstm
2025-12-14 08:49:23 | INFO     | Mode: 7class (7 classes)
2025-12-14 08:49:23 | INFO     | Data dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/data
2025-12-14 08:49:23 | INFO     | Save dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/models/seq_lstm
2025-12-14 08:49:23 | INFO     | Device: cuda
2025-12-14 08:49:23 | INFO     | Loaded pre-split data:
2025-12-14 08:49:23 | INFO     |   Train: (486, 256, 4) (may be augmented)
2025-12-14 08:49:23 | INFO     |   Val:   (42, 256, 4) (original)
2025-12-14 08:49:23 | INFO     |   Test:  (42, 256, 4) (original)
2025-12-14 08:49:23 | INFO     | Class names: ['None', 'Bearish Normal', 'Bearish Wedge', 'Bearish Pennant', 'Bullish Normal', 'Bullish Wedge', 'Bullish Pennant']
2025-12-14 08:49:23 | INFO     | Balanced: True
2025-12-14 08:49:23 | INFO     | Training label distribution:
2025-12-14 08:49:23 | INFO     |   None: 79288 (63.7%)
2025-12-14 08:49:23 | INFO     |   Bearish Normal: 4441 (3.6%)
2025-12-14 08:49:23 | INFO     |   Bearish Wedge: 7161 (5.8%)
2025-12-14 08:49:23 | INFO     |   Bearish Pennant: 11043 (8.9%)
2025-12-14 08:49:23 | INFO     |   Bullish Normal: 5949 (4.8%)
2025-12-14 08:49:23 | INFO     |   Bullish Wedge: 7684 (6.2%)
2025-12-14 08:49:23 | INFO     |   Bullish Pennant: 8850 (7.1%)
2025-12-14 08:49:23 | INFO     | Config: {'input_size': 4, 'hidden_size': 128, 'num_layers': 2, 'num_classes': 7, 'dropout': 0.2, 'bidirectional': False, 'learning_rate': 0.0005, 'batch_size': 16, 'epochs': 300, 'weight_decay': 1e-05, 'use_class_weights': True, 'max_class_weight': 10.0, 'patience': 50, 'min_delta': 0.0001, 'scheduler': 'cosine', 'warmup_epochs': 5, 'label_smoothing': 0.05, 'focal_loss': False, 'focal_gamma': 2.0, 'name': 'seq_lstm_7class', 'description': '7-class LSTM: detailed pattern type classification', 'mode': '7class'}
2025-12-14 08:49:23 | INFO     | Train: 486 samples
2025-12-14 08:49:23 | INFO     | Val:   42 samples
2025-12-14 08:49:23 | INFO     | Test:  42 samples
2025-12-14 08:49:23 | INFO     | Class weights (balanced): [0.1225082129240036, 1.2250821590423584, 1.2250821590423584, 0.8796008229255676, 1.2250821590423584, 1.2250821590423584, 1.0975629091262817]
2025-12-14 08:49:23 | INFO     | Model parameters: 201,607
2025-12-14 08:49:25 | INFO     | ============================================================
2025-12-14 08:49:25 | INFO     | TRAINING STARTED
2025-12-14 08:49:25 | INFO     | ============================================================
2025-12-14 08:49:25 | INFO     | Epoch   1/300 | Train Loss: 1.9184 Acc: 0.1865 | Val Loss: 1.9933 Acc: 0.0695 F1: 0.0394 | LR: 5.00e-04
2025-12-14 08:49:25 | INFO     |   -> New best model saved (F1: 0.0394)
2025-12-14 08:49:25 | INFO     | Epoch   2/300 | Train Loss: 1.8370 Acc: 0.2070 | Val Loss: 1.8287 Acc: 0.3937 F1: 0.1207 | LR: 5.00e-04
2025-12-14 08:49:25 | INFO     |   -> New best model saved (F1: 0.1207)
2025-12-14 08:49:25 | INFO     | Epoch   3/300 | Train Loss: 1.8199 Acc: 0.2566 | Val Loss: 1.8726 Acc: 0.1510 F1: 0.1050 | LR: 5.00e-04
2025-12-14 08:49:26 | INFO     | Epoch   4/300 | Train Loss: 1.8187 Acc: 0.2297 | Val Loss: 1.9036 Acc: 0.4298 F1: 0.1483 | LR: 5.00e-04
2025-12-14 08:49:26 | INFO     |   -> New best model saved (F1: 0.1483)
2025-12-14 08:49:26 | INFO     | Epoch   5/300 | Train Loss: 1.8331 Acc: 0.2790 | Val Loss: 1.8212 Acc: 0.3231 F1: 0.1433 | LR: 5.00e-04
2025-12-14 08:49:26 | INFO     | Epoch   6/300 | Train Loss: 1.7968 Acc: 0.2496 | Val Loss: 1.8222 Acc: 0.2771 F1: 0.1431 | LR: 5.00e-04
2025-12-14 08:49:26 | INFO     | Epoch   7/300 | Train Loss: 1.7844 Acc: 0.2911 | Val Loss: 1.7729 Acc: 0.2332 F1: 0.1350 | LR: 4.99e-04
2025-12-14 08:49:26 | INFO     | Epoch   8/300 | Train Loss: 1.7731 Acc: 0.2966 | Val Loss: 1.8052 Acc: 0.4036 F1: 0.1532 | LR: 4.99e-04
2025-12-14 08:49:26 | INFO     |   -> New best model saved (F1: 0.1532)
2025-12-14 08:49:27 | INFO     | Epoch   9/300 | Train Loss: 1.7386 Acc: 0.3066 | Val Loss: 1.7360 Acc: 0.2939 F1: 0.1365 | LR: 4.99e-04
2025-12-14 08:49:27 | INFO     | Epoch  10/300 | Train Loss: 1.7361 Acc: 0.3560 | Val Loss: 1.8543 Acc: 0.3132 F1: 0.1224 | LR: 4.99e-04
2025-12-14 08:49:27 | INFO     | Epoch  11/300 | Train Loss: 1.7172 Acc: 0.3267 | Val Loss: 1.7886 Acc: 0.2980 F1: 0.1354 | LR: 4.98e-04
2025-12-14 08:49:27 | INFO     | Epoch  12/300 | Train Loss: 1.7217 Acc: 0.3624 | Val Loss: 1.7588 Acc: 0.4237 F1: 0.1528 | LR: 4.98e-04
2025-12-14 08:49:27 | INFO     | Epoch  13/300 | Train Loss: 1.7237 Acc: 0.3251 | Val Loss: 1.7351 Acc: 0.4344 F1: 0.1753 | LR: 4.98e-04
2025-12-14 08:49:27 | INFO     |   -> New best model saved (F1: 0.1753)
2025-12-14 08:49:27 | INFO     | Epoch  14/300 | Train Loss: 1.6921 Acc: 0.3749 | Val Loss: 1.7155 Acc: 0.4048 F1: 0.1582 | LR: 4.97e-04
2025-12-14 08:49:28 | INFO     | Epoch  15/300 | Train Loss: 1.6946 Acc: 0.3611 | Val Loss: 1.7513 Acc: 0.3924 F1: 0.1604 | LR: 4.97e-04
2025-12-14 08:49:28 | INFO     | Epoch  16/300 | Train Loss: 1.6861 Acc: 0.3390 | Val Loss: 1.7793 Acc: 0.3709 F1: 0.1346 | LR: 4.97e-04
2025-12-14 08:49:28 | INFO     | Epoch  17/300 | Train Loss: 1.6710 Acc: 0.3503 | Val Loss: 1.7047 Acc: 0.3739 F1: 0.1633 | LR: 4.96e-04
2025-12-14 08:49:28 | INFO     | Epoch  18/300 | Train Loss: 1.6501 Acc: 0.3596 | Val Loss: 1.7833 Acc: 0.3638 F1: 0.1695 | LR: 4.96e-04
2025-12-14 08:49:28 | INFO     | Epoch  19/300 | Train Loss: 1.6832 Acc: 0.3961 | Val Loss: 1.7795 Acc: 0.4591 F1: 0.1857 | LR: 4.95e-04
2025-12-14 08:49:28 | INFO     |   -> New best model saved (F1: 0.1857)
2025-12-14 08:49:28 | INFO     | Epoch  20/300 | Train Loss: 1.6569 Acc: 0.3773 | Val Loss: 1.7073 Acc: 0.4145 F1: 0.1528 | LR: 4.95e-04
2025-12-14 08:49:29 | INFO     | Epoch  21/300 | Train Loss: 1.6429 Acc: 0.3834 | Val Loss: 1.7148 Acc: 0.4140 F1: 0.1627 | LR: 4.94e-04
2025-12-14 08:49:29 | INFO     | Epoch  22/300 | Train Loss: 1.6403 Acc: 0.3493 | Val Loss: 1.6670 Acc: 0.5138 F1: 0.1789 | LR: 4.93e-04
2025-12-14 08:49:29 | INFO     | Epoch  23/300 | Train Loss: 1.6283 Acc: 0.4080 | Val Loss: 1.6820 Acc: 0.4330 F1: 0.1669 | LR: 4.93e-04
2025-12-14 08:49:29 | INFO     | Epoch  24/300 | Train Loss: 1.6328 Acc: 0.3622 | Val Loss: 1.7589 Acc: 0.4439 F1: 0.1561 | LR: 4.92e-04
2025-12-14 08:49:29 | INFO     | Epoch  25/300 | Train Loss: 1.6301 Acc: 0.3629 | Val Loss: 1.6964 Acc: 0.4607 F1: 0.1699 | LR: 4.91e-04
2025-12-14 08:49:29 | INFO     | Epoch  26/300 | Train Loss: 1.6215 Acc: 0.4170 | Val Loss: 1.6919 Acc: 0.4866 F1: 0.1665 | LR: 4.91e-04
2025-12-14 08:49:30 | INFO     | Epoch  27/300 | Train Loss: 1.6176 Acc: 0.3577 | Val Loss: 1.7195 Acc: 0.4595 F1: 0.1628 | LR: 4.90e-04
2025-12-14 08:49:30 | INFO     | Epoch  28/300 | Train Loss: 1.6186 Acc: 0.3886 | Val Loss: 1.6821 Acc: 0.4581 F1: 0.1656 | LR: 4.89e-04
2025-12-14 08:49:30 | INFO     | Epoch  29/300 | Train Loss: 1.6085 Acc: 0.4030 | Val Loss: 1.7060 Acc: 0.5366 F1: 0.1708 | LR: 4.89e-04
2025-12-14 08:49:30 | INFO     | Epoch  30/300 | Train Loss: 1.6036 Acc: 0.3923 | Val Loss: 1.7381 Acc: 0.3887 F1: 0.1528 | LR: 4.88e-04
2025-12-14 08:49:30 | INFO     | Epoch  31/300 | Train Loss: 1.5801 Acc: 0.3756 | Val Loss: 1.7110 Acc: 0.4837 F1: 0.1697 | LR: 4.87e-04
2025-12-14 08:49:30 | INFO     | Epoch  32/300 | Train Loss: 1.6105 Acc: 0.3956 | Val Loss: 1.7109 Acc: 0.4616 F1: 0.1700 | LR: 4.86e-04
2025-12-14 08:49:31 | INFO     | Epoch  33/300 | Train Loss: 1.6227 Acc: 0.3829 | Val Loss: 1.7269 Acc: 0.4398 F1: 0.1644 | LR: 4.85e-04
2025-12-14 08:49:31 | INFO     | Epoch  34/300 | Train Loss: 1.5870 Acc: 0.4025 | Val Loss: 1.6919 Acc: 0.4888 F1: 0.1757 | LR: 4.84e-04
2025-12-14 08:49:31 | INFO     | Epoch  35/300 | Train Loss: 1.5704 Acc: 0.3994 | Val Loss: 1.6906 Acc: 0.4359 F1: 0.1437 | LR: 4.83e-04
2025-12-14 08:49:31 | INFO     | Epoch  36/300 | Train Loss: 1.5599 Acc: 0.3970 | Val Loss: 1.6729 Acc: 0.4828 F1: 0.1685 | LR: 4.82e-04
2025-12-14 08:49:31 | INFO     | Epoch  37/300 | Train Loss: 1.5889 Acc: 0.3820 | Val Loss: 1.6906 Acc: 0.4797 F1: 0.1563 | LR: 4.82e-04
2025-12-14 08:49:32 | INFO     | Epoch  38/300 | Train Loss: 1.5692 Acc: 0.3825 | Val Loss: 1.6870 Acc: 0.5038 F1: 0.1616 | LR: 4.81e-04
2025-12-14 08:49:32 | INFO     | Epoch  39/300 | Train Loss: 1.5641 Acc: 0.4232 | Val Loss: 1.6862 Acc: 0.4986 F1: 0.1766 | LR: 4.79e-04
2025-12-14 08:49:32 | INFO     | Epoch  40/300 | Train Loss: 1.5737 Acc: 0.4033 | Val Loss: 1.7501 Acc: 0.3809 F1: 0.1431 | LR: 4.78e-04
2025-12-14 08:49:32 | INFO     | Epoch  41/300 | Train Loss: 1.5471 Acc: 0.4037 | Val Loss: 1.6872 Acc: 0.4673 F1: 0.1543 | LR: 4.77e-04
2025-12-14 08:49:32 | INFO     | Epoch  42/300 | Train Loss: 1.5180 Acc: 0.4229 | Val Loss: 1.6802 Acc: 0.5167 F1: 0.1730 | LR: 4.76e-04
2025-12-14 08:49:32 | INFO     | Epoch  43/300 | Train Loss: 1.5892 Acc: 0.4053 | Val Loss: 1.6845 Acc: 0.4901 F1: 0.1762 | LR: 4.75e-04
2025-12-14 08:49:33 | INFO     | Epoch  44/300 | Train Loss: 1.5366 Acc: 0.4247 | Val Loss: 1.6896 Acc: 0.4096 F1: 0.1545 | LR: 4.74e-04
2025-12-14 08:49:33 | INFO     | Epoch  45/300 | Train Loss: 1.5184 Acc: 0.4135 | Val Loss: 1.7152 Acc: 0.4500 F1: 0.1609 | LR: 4.73e-04
2025-12-14 08:49:33 | INFO     | Epoch  46/300 | Train Loss: 1.5240 Acc: 0.4241 | Val Loss: 1.6800 Acc: 0.5101 F1: 0.1775 | LR: 4.72e-04
2025-12-14 08:49:33 | INFO     | Epoch  47/300 | Train Loss: 1.5178 Acc: 0.4284 | Val Loss: 1.6951 Acc: 0.4543 F1: 0.1626 | LR: 4.70e-04
2025-12-14 08:49:33 | INFO     | Epoch  48/300 | Train Loss: 1.4956 Acc: 0.4425 | Val Loss: 1.7242 Acc: 0.4219 F1: 0.1454 | LR: 4.69e-04
2025-12-14 08:49:33 | INFO     | Epoch  49/300 | Train Loss: 1.5747 Acc: 0.3967 | Val Loss: 1.7120 Acc: 0.4080 F1: 0.1518 | LR: 4.68e-04
2025-12-14 08:49:34 | INFO     | Epoch  50/300 | Train Loss: 1.5363 Acc: 0.4175 | Val Loss: 1.7190 Acc: 0.4208 F1: 0.1472 | LR: 4.67e-04
2025-12-14 08:49:34 | INFO     | Epoch  51/300 | Train Loss: 1.5313 Acc: 0.4020 | Val Loss: 1.7700 Acc: 0.4062 F1: 0.1524 | LR: 4.65e-04
2025-12-14 08:49:34 | INFO     | Epoch  52/300 | Train Loss: 1.5146 Acc: 0.4271 | Val Loss: 1.8018 Acc: 0.4299 F1: 0.1465 | LR: 4.64e-04
2025-12-14 08:49:34 | INFO     | Epoch  53/300 | Train Loss: 1.5050 Acc: 0.4233 | Val Loss: 1.7888 Acc: 0.4165 F1: 0.1502 | LR: 4.63e-04
2025-12-14 08:49:34 | INFO     | Epoch  54/300 | Train Loss: 1.4603 Acc: 0.4121 | Val Loss: 1.7337 Acc: 0.4448 F1: 0.1549 | LR: 4.61e-04
2025-12-14 08:49:34 | INFO     | Epoch  55/300 | Train Loss: 1.4442 Acc: 0.4293 | Val Loss: 1.6896 Acc: 0.4947 F1: 0.1712 | LR: 4.60e-04
2025-12-14 08:49:35 | INFO     | Epoch  56/300 | Train Loss: 1.5026 Acc: 0.4212 | Val Loss: 1.7064 Acc: 0.4853 F1: 0.1685 | LR: 4.58e-04
2025-12-14 08:49:35 | INFO     | Epoch  57/300 | Train Loss: 1.4441 Acc: 0.4462 | Val Loss: 1.7395 Acc: 0.4683 F1: 0.1684 | LR: 4.57e-04
2025-12-14 08:49:35 | INFO     | Epoch  58/300 | Train Loss: 1.4733 Acc: 0.4267 | Val Loss: 1.7760 Acc: 0.4337 F1: 0.1489 | LR: 4.55e-04
2025-12-14 08:49:35 | INFO     | Epoch  59/300 | Train Loss: 1.4649 Acc: 0.4213 | Val Loss: 1.8196 Acc: 0.4085 F1: 0.1477 | LR: 4.54e-04
2025-12-14 08:49:35 | INFO     | Epoch  60/300 | Train Loss: 1.4471 Acc: 0.4273 | Val Loss: 1.7556 Acc: 0.4916 F1: 0.1596 | LR: 4.52e-04
2025-12-14 08:49:35 | INFO     | Epoch  61/300 | Train Loss: 1.4756 Acc: 0.4350 | Val Loss: 1.8174 Acc: 0.4475 F1: 0.1563 | LR: 4.51e-04
2025-12-14 08:49:36 | INFO     | Epoch  62/300 | Train Loss: 1.5143 Acc: 0.4142 | Val Loss: 1.8205 Acc: 0.4202 F1: 0.1528 | LR: 4.49e-04
2025-12-14 08:49:36 | INFO     | Epoch  63/300 | Train Loss: 1.4947 Acc: 0.4138 | Val Loss: 1.8243 Acc: 0.3929 F1: 0.1405 | LR: 4.48e-04
2025-12-14 08:49:36 | INFO     | Epoch  64/300 | Train Loss: 1.4942 Acc: 0.3895 | Val Loss: 1.7405 Acc: 0.3779 F1: 0.1389 | LR: 4.46e-04
2025-12-14 08:49:36 | INFO     | Epoch  65/300 | Train Loss: 1.4633 Acc: 0.4287 | Val Loss: 1.6993 Acc: 0.5009 F1: 0.1712 | LR: 4.44e-04
2025-12-14 08:49:36 | INFO     | Epoch  66/300 | Train Loss: 1.4292 Acc: 0.4384 | Val Loss: 1.7109 Acc: 0.4828 F1: 0.1764 | LR: 4.43e-04
2025-12-14 08:49:36 | INFO     | Epoch  67/300 | Train Loss: 1.4671 Acc: 0.4240 | Val Loss: 1.7857 Acc: 0.4617 F1: 0.1510 | LR: 4.41e-04
2025-12-14 08:49:37 | INFO     | Epoch  68/300 | Train Loss: 1.4543 Acc: 0.4350 | Val Loss: 1.8088 Acc: 0.4485 F1: 0.1612 | LR: 4.39e-04
2025-12-14 08:49:37 | INFO     | Epoch  69/300 | Train Loss: 1.4934 Acc: 0.4021 | Val Loss: 1.8241 Acc: 0.4183 F1: 0.1429 | LR: 4.38e-04
2025-12-14 08:49:37 | INFO     | Early stopping at epoch 69
2025-12-14 08:49:37 | INFO     | ============================================================
2025-12-14 08:49:37 | INFO     | EVALUATING BEST MODEL ON TEST SET
2025-12-14 08:49:37 | INFO     | ============================================================
2025-12-14 08:49:37 | INFO     | 
Test Loss: 1.9560
2025-12-14 08:49:37 | INFO     | Test Accuracy: 0.4087
2025-12-14 08:49:37 | INFO     | ============================================================
SEQUENCE LABELING METRICS
============================================================

Standard Metrics:
  Accuracy:         0.4087
  F1 (micro):       0.4087
  F1 (macro):       0.1353
  F1 (weighted):    0.4994

Pattern Detection Metrics:
  Coverage Score:   0.3184
  Detection Rate:   0.9524
  False Alarm Rate: 0.4834
  Boundary Acc:     0.2262

Pattern-Level Metrics:
  Pattern Precision: 0.0132
  Pattern Recall:    0.0476
  Pattern F1:        0.0207

ROC-AUC (macro):     0.5359

Per-Class F1:
  None                : 0.6380
  Bearish Normal      : 0.2421
  Bearish Wedge       : 0.0000
  Bearish Pennant     : 0.0433
  Bullish Normal      : 0.0233
  Bullish Wedge       : 0.0000
  Bullish Pennant     : 0.0000
============================================================
2025-12-14 08:49:37 | INFO     | ============================================================
2025-12-14 08:49:37 | INFO     | TRAINING COMPLETE
2025-12-14 08:49:37 | INFO     | ============================================================
