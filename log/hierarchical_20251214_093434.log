2025-12-14 09:34:34 | INFO     | ============================================================
2025-12-14 09:34:34 | INFO     | HIERARCHICAL CLASSIFICATION TRAINING
2025-12-14 09:34:34 | INFO     | ============================================================
2025-12-14 09:34:34 | INFO     | Data dir: data
2025-12-14 09:34:34 | INFO     | Save dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/models/hierarchical
2025-12-14 09:34:34 | INFO     | Device: cuda
2025-12-14 09:34:34 | INFO     | Loaded: 300 samples
2025-12-14 09:34:34 | INFO     | 
============================================================
2025-12-14 09:34:34 | INFO     | TRAINING STAGE 1: Direction Classifier
2025-12-14 09:34:34 | INFO     | ============================================================
2025-12-14 09:34:34 | INFO     | Train: 522 samples
2025-12-14 09:34:34 | INFO     | Val: 49 samples
2025-12-14 09:34:34 | INFO     | Train distribution:
2025-12-14 09:34:34 | INFO     |   None: 88861 (66.5%)
2025-12-14 09:34:34 | INFO     |   Bearish: 27778 (20.8%)
2025-12-14 09:34:34 | INFO     |   Bullish: 16993 (12.7%)
2025-12-14 09:34:34 | INFO     | Val distribution:
2025-12-14 09:34:34 | INFO     |   None: 8662 (69.1%)
2025-12-14 09:34:34 | INFO     |   Bearish: 2428 (19.4%)
2025-12-14 09:34:34 | INFO     |   Bullish: 1454 (11.6%)
2025-12-14 09:34:34 | INFO     | Class weights: [0.3181929588317871, 1.0178898572921753, 1.6639171838760376]
2025-12-14 09:34:34 | INFO     | Model parameters: 201,091
2025-12-14 09:34:36 | INFO     | Epoch   1/300 | Train Loss: 1.2052 Acc: 0.3508 | Val Loss: 1.1198 Acc: 0.4243 F1: 0.2936
2025-12-14 09:34:36 | INFO     |   -> New best model saved (F1: 0.2936)
2025-12-14 09:34:36 | INFO     | Epoch   2/300 | Train Loss: 1.1434 Acc: 0.3911 | Val Loss: 1.0969 Acc: 0.5010 F1: 0.3991
2025-12-14 09:34:36 | INFO     |   -> New best model saved (F1: 0.3991)
2025-12-14 09:34:36 | INFO     | Epoch   3/300 | Train Loss: 1.1134 Acc: 0.4439 | Val Loss: 1.0858 Acc: 0.5754 F1: 0.4351
2025-12-14 09:34:36 | INFO     |   -> New best model saved (F1: 0.4351)
2025-12-14 09:34:36 | INFO     | Epoch   4/300 | Train Loss: 1.1010 Acc: 0.4966 | Val Loss: 1.1002 Acc: 0.4416 F1: 0.3278
2025-12-14 09:34:36 | INFO     | Epoch   5/300 | Train Loss: 1.0849 Acc: 0.5194 | Val Loss: 1.0823 Acc: 0.5252 F1: 0.3807
2025-12-14 09:34:36 | INFO     | Epoch   6/300 | Train Loss: 1.0795 Acc: 0.4995 | Val Loss: 1.0186 Acc: 0.6768 F1: 0.5151
2025-12-14 09:34:36 | INFO     |   -> New best model saved (F1: 0.5151)
2025-12-14 09:34:36 | INFO     | Epoch   7/300 | Train Loss: 1.0874 Acc: 0.4992 | Val Loss: 1.0298 Acc: 0.6643 F1: 0.5148
2025-12-14 09:34:37 | INFO     | Epoch   8/300 | Train Loss: 1.0825 Acc: 0.5452 | Val Loss: 1.0438 Acc: 0.6224 F1: 0.4267
2025-12-14 09:34:37 | INFO     | Epoch   9/300 | Train Loss: 1.0692 Acc: 0.5622 | Val Loss: 1.0391 Acc: 0.6258 F1: 0.4186
2025-12-14 09:34:37 | INFO     | Epoch  10/300 | Train Loss: 1.0662 Acc: 0.5446 | Val Loss: 1.0367 Acc: 0.6290 F1: 0.4005
2025-12-14 09:34:37 | INFO     | Epoch  11/300 | Train Loss: 1.0656 Acc: 0.5454 | Val Loss: 1.0341 Acc: 0.5611 F1: 0.4471
2025-12-14 09:34:37 | INFO     | Epoch  12/300 | Train Loss: 1.0590 Acc: 0.5553 | Val Loss: 1.0323 Acc: 0.6138 F1: 0.4523
2025-12-14 09:34:37 | INFO     | Epoch  13/300 | Train Loss: 1.0599 Acc: 0.5640 | Val Loss: 1.0362 Acc: 0.6472 F1: 0.4726
2025-12-14 09:34:37 | INFO     | Epoch  14/300 | Train Loss: 1.0711 Acc: 0.5090 | Val Loss: 1.0521 Acc: 0.6142 F1: 0.4353
2025-12-14 09:34:38 | INFO     | Epoch  15/300 | Train Loss: 1.0609 Acc: 0.5155 | Val Loss: 1.0165 Acc: 0.6356 F1: 0.4716
2025-12-14 09:34:38 | INFO     | Epoch  16/300 | Train Loss: 1.0496 Acc: 0.5579 | Val Loss: 1.0084 Acc: 0.7010 F1: 0.4936
2025-12-14 09:34:38 | INFO     | Epoch  17/300 | Train Loss: 1.0478 Acc: 0.5865 | Val Loss: 1.0247 Acc: 0.6437 F1: 0.4916
2025-12-14 09:34:38 | INFO     | Epoch  18/300 | Train Loss: 1.0529 Acc: 0.5829 | Val Loss: 1.0194 Acc: 0.6019 F1: 0.4634
2025-12-14 09:34:38 | INFO     | Epoch  19/300 | Train Loss: 1.0503 Acc: 0.5408 | Val Loss: 0.9890 Acc: 0.6621 F1: 0.4788
2025-12-14 09:34:38 | INFO     | Epoch  20/300 | Train Loss: 1.0436 Acc: 0.5520 | Val Loss: 1.0152 Acc: 0.6588 F1: 0.4650
2025-12-14 09:34:38 | INFO     | Epoch  21/300 | Train Loss: 1.0366 Acc: 0.5695 | Val Loss: 1.0042 Acc: 0.6340 F1: 0.4483
2025-12-14 09:34:39 | INFO     | Epoch  22/300 | Train Loss: 1.0357 Acc: 0.5851 | Val Loss: 0.9852 Acc: 0.6382 F1: 0.4548
2025-12-14 09:34:39 | INFO     | Epoch  23/300 | Train Loss: 1.0370 Acc: 0.5438 | Val Loss: 1.0181 Acc: 0.5582 F1: 0.4103
2025-12-14 09:34:39 | INFO     | Epoch  24/300 | Train Loss: 1.0447 Acc: 0.5394 | Val Loss: 0.9977 Acc: 0.6445 F1: 0.4865
2025-12-14 09:34:39 | INFO     | Epoch  25/300 | Train Loss: 1.0371 Acc: 0.5494 | Val Loss: 1.0048 Acc: 0.6063 F1: 0.4447
2025-12-14 09:34:39 | INFO     | Epoch  26/300 | Train Loss: 1.0312 Acc: 0.5501 | Val Loss: 0.9799 Acc: 0.6426 F1: 0.4923
2025-12-14 09:34:39 | INFO     | Epoch  27/300 | Train Loss: 1.0247 Acc: 0.5615 | Val Loss: 0.9777 Acc: 0.6801 F1: 0.4832
2025-12-14 09:34:39 | INFO     | Epoch  28/300 | Train Loss: 1.0248 Acc: 0.5420 | Val Loss: 0.9996 Acc: 0.6207 F1: 0.4327
2025-12-14 09:34:40 | INFO     | Epoch  29/300 | Train Loss: 1.0310 Acc: 0.5340 | Val Loss: 0.9832 Acc: 0.6435 F1: 0.4768
2025-12-14 09:34:40 | INFO     | Epoch  30/300 | Train Loss: 1.0269 Acc: 0.5689 | Val Loss: 1.0195 Acc: 0.6675 F1: 0.4333
2025-12-14 09:34:40 | INFO     | Epoch  31/300 | Train Loss: 1.0428 Acc: 0.5819 | Val Loss: 0.9924 Acc: 0.6490 F1: 0.4673
2025-12-14 09:34:40 | INFO     | Epoch  32/300 | Train Loss: 1.0189 Acc: 0.5806 | Val Loss: 1.0001 Acc: 0.6578 F1: 0.4816
2025-12-14 09:34:40 | INFO     | Epoch  33/300 | Train Loss: 1.0272 Acc: 0.5465 | Val Loss: 1.0016 Acc: 0.6537 F1: 0.4618
2025-12-14 09:34:40 | INFO     | Epoch  34/300 | Train Loss: 1.0247 Acc: 0.5536 | Val Loss: 1.0010 Acc: 0.6718 F1: 0.4789
2025-12-14 09:34:40 | INFO     | Epoch  35/300 | Train Loss: 1.0175 Acc: 0.5610 | Val Loss: 0.9974 Acc: 0.6922 F1: 0.4940
2025-12-14 09:34:41 | INFO     | Epoch  36/300 | Train Loss: 1.0180 Acc: 0.5617 | Val Loss: 0.9980 Acc: 0.5599 F1: 0.4255
2025-12-14 09:34:41 | INFO     | Epoch  37/300 | Train Loss: 1.0202 Acc: 0.5293 | Val Loss: 1.0262 Acc: 0.6210 F1: 0.4223
2025-12-14 09:34:41 | INFO     | Epoch  38/300 | Train Loss: 1.0119 Acc: 0.5611 | Val Loss: 1.0091 Acc: 0.6979 F1: 0.4885
2025-12-14 09:34:41 | INFO     | Epoch  39/300 | Train Loss: 1.0117 Acc: 0.5684 | Val Loss: 1.0086 Acc: 0.6669 F1: 0.4723
2025-12-14 09:34:41 | INFO     | Epoch  40/300 | Train Loss: 1.0141 Acc: 0.5733 | Val Loss: 0.9994 Acc: 0.6751 F1: 0.4802
2025-12-14 09:34:41 | INFO     | Epoch  41/300 | Train Loss: 1.0138 Acc: 0.5715 | Val Loss: 1.0068 Acc: 0.6822 F1: 0.4929
2025-12-14 09:34:41 | INFO     | Epoch  42/300 | Train Loss: 1.0083 Acc: 0.5708 | Val Loss: 1.0234 Acc: 0.6416 F1: 0.4688
2025-12-14 09:34:42 | INFO     | Epoch  43/300 | Train Loss: 1.0034 Acc: 0.5834 | Val Loss: 1.0026 Acc: 0.6438 F1: 0.4727
2025-12-14 09:34:42 | INFO     | Epoch  44/300 | Train Loss: 1.0084 Acc: 0.5470 | Val Loss: 1.0242 Acc: 0.6817 F1: 0.4765
2025-12-14 09:34:42 | INFO     | Epoch  45/300 | Train Loss: 1.0092 Acc: 0.5498 | Val Loss: 0.9867 Acc: 0.6830 F1: 0.4935
2025-12-14 09:34:42 | INFO     | Epoch  46/300 | Train Loss: 1.0035 Acc: 0.5712 | Val Loss: 0.9912 Acc: 0.6889 F1: 0.4792
2025-12-14 09:34:42 | INFO     | Epoch  47/300 | Train Loss: 1.0037 Acc: 0.5939 | Val Loss: 0.9819 Acc: 0.6820 F1: 0.4945
2025-12-14 09:34:42 | INFO     | Epoch  48/300 | Train Loss: 0.9949 Acc: 0.5686 | Val Loss: 1.0029 Acc: 0.6640 F1: 0.4874
2025-12-14 09:34:42 | INFO     | Epoch  49/300 | Train Loss: 1.0002 Acc: 0.5843 | Val Loss: 0.9579 Acc: 0.6877 F1: 0.5511
2025-12-14 09:34:42 | INFO     |   -> New best model saved (F1: 0.5511)
2025-12-14 09:34:43 | INFO     | Epoch  50/300 | Train Loss: 0.9998 Acc: 0.5616 | Val Loss: 1.0299 Acc: 0.6476 F1: 0.4803
2025-12-14 09:34:43 | INFO     | Epoch  51/300 | Train Loss: 0.9881 Acc: 0.5745 | Val Loss: 1.0001 Acc: 0.6739 F1: 0.5194
2025-12-14 09:34:43 | INFO     | Epoch  52/300 | Train Loss: 1.0039 Acc: 0.5757 | Val Loss: 0.9960 Acc: 0.6674 F1: 0.5097
2025-12-14 09:34:43 | INFO     | Epoch  53/300 | Train Loss: 1.0230 Acc: 0.5404 | Val Loss: 1.0164 Acc: 0.6989 F1: 0.5255
2025-12-14 09:34:43 | INFO     | Epoch  54/300 | Train Loss: 1.0093 Acc: 0.5703 | Val Loss: 1.0042 Acc: 0.6698 F1: 0.4695
2025-12-14 09:34:43 | INFO     | Epoch  55/300 | Train Loss: 1.0137 Acc: 0.5703 | Val Loss: 0.9907 Acc: 0.6479 F1: 0.5027
2025-12-14 09:34:44 | INFO     | Epoch  56/300 | Train Loss: 1.0037 Acc: 0.5322 | Val Loss: 1.0019 Acc: 0.6197 F1: 0.4839
2025-12-14 09:34:44 | INFO     | Epoch  57/300 | Train Loss: 0.9910 Acc: 0.5690 | Val Loss: 1.0128 Acc: 0.7116 F1: 0.5149
2025-12-14 09:34:44 | INFO     | Epoch  58/300 | Train Loss: 1.0020 Acc: 0.5465 | Val Loss: 0.9997 Acc: 0.7056 F1: 0.5246
2025-12-14 09:34:44 | INFO     | Epoch  59/300 | Train Loss: 0.9946 Acc: 0.5790 | Val Loss: 1.0066 Acc: 0.6685 F1: 0.4929
2025-12-14 09:34:44 | INFO     | Epoch  60/300 | Train Loss: 0.9992 Acc: 0.5730 | Val Loss: 1.0419 Acc: 0.7008 F1: 0.4723
2025-12-14 09:34:44 | INFO     | Epoch  61/300 | Train Loss: 1.0108 Acc: 0.5796 | Val Loss: 0.9941 Acc: 0.6986 F1: 0.5206
2025-12-14 09:34:44 | INFO     | Epoch  62/300 | Train Loss: 0.9938 Acc: 0.5669 | Val Loss: 1.0046 Acc: 0.6724 F1: 0.4860
2025-12-14 09:34:45 | INFO     | Epoch  63/300 | Train Loss: 1.0198 Acc: 0.5767 | Val Loss: 0.9794 Acc: 0.6629 F1: 0.4778
2025-12-14 09:34:45 | INFO     | Epoch  64/300 | Train Loss: 1.0118 Acc: 0.5854 | Val Loss: 0.9926 Acc: 0.6578 F1: 0.4745
2025-12-14 09:34:45 | INFO     | Epoch  65/300 | Train Loss: 1.0047 Acc: 0.5507 | Val Loss: 0.9958 Acc: 0.6801 F1: 0.4813
2025-12-14 09:34:45 | INFO     | Epoch  66/300 | Train Loss: 0.9971 Acc: 0.5672 | Val Loss: 0.9995 Acc: 0.6610 F1: 0.4777
2025-12-14 09:34:45 | INFO     | Epoch  67/300 | Train Loss: 0.9822 Acc: 0.5793 | Val Loss: 0.9947 Acc: 0.7029 F1: 0.5122
2025-12-14 09:34:45 | INFO     | Epoch  68/300 | Train Loss: 0.9856 Acc: 0.5729 | Val Loss: 1.0075 Acc: 0.6982 F1: 0.5075
2025-12-14 09:34:45 | INFO     | Epoch  69/300 | Train Loss: 0.9949 Acc: 0.5663 | Val Loss: 1.0234 Acc: 0.6310 F1: 0.4763
2025-12-14 09:34:46 | INFO     | Epoch  70/300 | Train Loss: 0.9883 Acc: 0.5723 | Val Loss: 1.0204 Acc: 0.6537 F1: 0.4770
2025-12-14 09:34:46 | INFO     | Epoch  71/300 | Train Loss: 0.9839 Acc: 0.5555 | Val Loss: 1.0287 Acc: 0.6897 F1: 0.5182
2025-12-14 09:34:46 | INFO     | Epoch  72/300 | Train Loss: 1.0000 Acc: 0.5842 | Val Loss: 0.9939 Acc: 0.6404 F1: 0.4977
2025-12-14 09:34:46 | INFO     | Epoch  73/300 | Train Loss: 0.9749 Acc: 0.5749 | Val Loss: 1.0205 Acc: 0.6877 F1: 0.5104
2025-12-14 09:34:46 | INFO     | Epoch  74/300 | Train Loss: 0.9830 Acc: 0.5733 | Val Loss: 0.9885 Acc: 0.6709 F1: 0.5239
2025-12-14 09:34:46 | INFO     | Epoch  75/300 | Train Loss: 0.9732 Acc: 0.5826 | Val Loss: 1.0093 Acc: 0.6397 F1: 0.4868
2025-12-14 09:34:46 | INFO     | Epoch  76/300 | Train Loss: 0.9767 Acc: 0.5549 | Val Loss: 0.9941 Acc: 0.6654 F1: 0.5151
2025-12-14 09:34:47 | INFO     | Epoch  77/300 | Train Loss: 0.9763 Acc: 0.5857 | Val Loss: 1.0251 Acc: 0.6724 F1: 0.5122
2025-12-14 09:34:47 | INFO     | Epoch  78/300 | Train Loss: 0.9729 Acc: 0.5642 | Val Loss: 1.0232 Acc: 0.6372 F1: 0.5019
2025-12-14 09:34:47 | INFO     | Epoch  79/300 | Train Loss: 0.9773 Acc: 0.5687 | Val Loss: 1.0243 Acc: 0.6970 F1: 0.5127
2025-12-14 09:34:47 | INFO     | Epoch  80/300 | Train Loss: 0.9782 Acc: 0.6077 | Val Loss: 1.0114 Acc: 0.6523 F1: 0.5014
2025-12-14 09:34:47 | INFO     | Epoch  81/300 | Train Loss: 0.9737 Acc: 0.5607 | Val Loss: 1.0128 Acc: 0.6700 F1: 0.5237
2025-12-14 09:34:47 | INFO     | Epoch  82/300 | Train Loss: 0.9920 Acc: 0.5658 | Val Loss: 0.9847 Acc: 0.6562 F1: 0.5111
2025-12-14 09:34:47 | INFO     | Epoch  83/300 | Train Loss: 0.9799 Acc: 0.5553 | Val Loss: 1.0356 Acc: 0.6560 F1: 0.5040
2025-12-14 09:34:48 | INFO     | Epoch  84/300 | Train Loss: 0.9566 Acc: 0.5814 | Val Loss: 1.0408 Acc: 0.6890 F1: 0.5235
2025-12-14 09:34:48 | INFO     | Epoch  85/300 | Train Loss: 0.9641 Acc: 0.5880 | Val Loss: 1.0339 Acc: 0.6707 F1: 0.5200
2025-12-14 09:34:48 | INFO     | Epoch  86/300 | Train Loss: 0.9522 Acc: 0.5775 | Val Loss: 1.0090 Acc: 0.7170 F1: 0.5413
2025-12-14 09:34:48 | INFO     | Epoch  87/300 | Train Loss: 0.9762 Acc: 0.5841 | Val Loss: 0.9842 Acc: 0.6932 F1: 0.5349
2025-12-14 09:34:48 | INFO     | Epoch  88/300 | Train Loss: 0.9633 Acc: 0.5820 | Val Loss: 1.0176 Acc: 0.6914 F1: 0.5311
2025-12-14 09:34:48 | INFO     | Epoch  89/300 | Train Loss: 0.9573 Acc: 0.5881 | Val Loss: 1.0181 Acc: 0.6877 F1: 0.5269
2025-12-14 09:34:48 | INFO     | Epoch  90/300 | Train Loss: 0.9430 Acc: 0.5967 | Val Loss: 1.0664 Acc: 0.6378 F1: 0.4969
2025-12-14 09:34:48 | INFO     | Epoch  91/300 | Train Loss: 0.9705 Acc: 0.5575 | Val Loss: 1.0304 Acc: 0.6667 F1: 0.5190
2025-12-14 09:34:49 | INFO     | Epoch  92/300 | Train Loss: 0.9622 Acc: 0.5578 | Val Loss: 1.0125 Acc: 0.6901 F1: 0.5308
2025-12-14 09:34:49 | INFO     | Epoch  93/300 | Train Loss: 0.9430 Acc: 0.5953 | Val Loss: 0.9796 Acc: 0.6683 F1: 0.5358
2025-12-14 09:34:49 | INFO     | Epoch  94/300 | Train Loss: 0.9558 Acc: 0.5736 | Val Loss: 1.0464 Acc: 0.6473 F1: 0.5026
2025-12-14 09:34:49 | INFO     | Epoch  95/300 | Train Loss: 0.9726 Acc: 0.5629 | Val Loss: 1.0693 Acc: 0.6588 F1: 0.5078
2025-12-14 09:34:49 | INFO     | Epoch  96/300 | Train Loss: 0.9477 Acc: 0.5736 | Val Loss: 1.0470 Acc: 0.6920 F1: 0.5182
2025-12-14 09:34:49 | INFO     | Epoch  97/300 | Train Loss: 0.9698 Acc: 0.5865 | Val Loss: 1.0393 Acc: 0.6960 F1: 0.5286
2025-12-14 09:34:49 | INFO     | Epoch  98/300 | Train Loss: 0.9606 Acc: 0.5989 | Val Loss: 1.0123 Acc: 0.6866 F1: 0.5326
2025-12-14 09:34:50 | INFO     | Epoch  99/300 | Train Loss: 0.9519 Acc: 0.5887 | Val Loss: 1.0159 Acc: 0.6668 F1: 0.5070
2025-12-14 09:34:50 | INFO     | Early stopping at epoch 99
2025-12-14 09:34:50 | INFO     | 
============================================================
2025-12-14 09:34:50 | INFO     | TRAINING STAGE 2: Subtype Classifier
2025-12-14 09:34:50 | INFO     | ============================================================
2025-12-14 09:34:50 | INFO     | Train: 522 samples, 44771 pattern timesteps
2025-12-14 09:34:50 | INFO     | Val: 49 samples, 3882 pattern timesteps
2025-12-14 09:34:50 | INFO     | Train subtype distribution (pattern regions):
2025-12-14 09:34:50 | INFO     |   Normal: 9627 (21.5%)
2025-12-14 09:34:50 | INFO     |   Wedge: 14402 (32.2%)
2025-12-14 09:34:50 | INFO     |   Pennant: 20742 (46.3%)
2025-12-14 09:34:50 | INFO     | Val subtype distribution (pattern regions):
2025-12-14 09:34:50 | INFO     |   Normal: 2543 (65.5%)
2025-12-14 09:34:50 | INFO     |   Wedge: 973 (25.1%)
2025-12-14 09:34:50 | INFO     |   Pennant: 366 (9.4%)
2025-12-14 09:34:50 | INFO     | Class weights: [1.550188660621643, 1.0362218618392944, 1.0]
2025-12-14 09:34:50 | INFO     | Model parameters: 51,395
2025-12-14 09:34:50 | INFO     | Epoch   1/200 | Train Loss: 1.2133 Acc: 0.5145 | Val Loss: 1.4006 Acc: 0.5528 F1: 0.3993
2025-12-14 09:34:50 | INFO     |   -> New best model saved (F1: 0.3993)
2025-12-14 09:34:50 | INFO     | Epoch   2/200 | Train Loss: 1.1414 Acc: 0.5332 | Val Loss: 1.4307 Acc: 0.6337 F1: 0.4260
2025-12-14 09:34:50 | INFO     |   -> New best model saved (F1: 0.4260)
2025-12-14 09:34:50 | INFO     | Epoch   3/200 | Train Loss: 1.1405 Acc: 0.5292 | Val Loss: 1.6406 Acc: 0.5585 F1: 0.3960
2025-12-14 09:34:50 | INFO     | Epoch   4/200 | Train Loss: 1.1255 Acc: 0.5298 | Val Loss: 1.4277 Acc: 0.5443 F1: 0.4110
2025-12-14 09:34:51 | INFO     | Epoch   5/200 | Train Loss: 1.1005 Acc: 0.5592 | Val Loss: 1.4581 Acc: 0.5541 F1: 0.3797
2025-12-14 09:34:51 | INFO     | Epoch   6/200 | Train Loss: 1.1147 Acc: 0.5477 | Val Loss: 1.3319 Acc: 0.5768 F1: 0.3936
2025-12-14 09:34:51 | INFO     | Epoch   7/200 | Train Loss: 1.1294 Acc: 0.5574 | Val Loss: 1.3502 Acc: 0.5559 F1: 0.3791
2025-12-14 09:34:51 | INFO     | Epoch   8/200 | Train Loss: 1.1470 Acc: 0.5352 | Val Loss: 1.3485 Acc: 0.5353 F1: 0.2407
2025-12-14 09:34:51 | INFO     | Epoch   9/200 | Train Loss: 1.0772 Acc: 0.5723 | Val Loss: 1.5717 Acc: 0.4670 F1: 0.3194
2025-12-14 09:34:51 | INFO     | Epoch  10/200 | Train Loss: 1.0862 Acc: 0.5540 | Val Loss: 1.3801 Acc: 0.5526 F1: 0.3810
2025-12-14 09:34:51 | INFO     | Epoch  11/200 | Train Loss: 1.1188 Acc: 0.5824 | Val Loss: 1.4373 Acc: 0.5647 F1: 0.3825
2025-12-14 09:34:51 | INFO     | Epoch  12/200 | Train Loss: 1.0959 Acc: 0.5816 | Val Loss: 1.4414 Acc: 0.5652 F1: 0.3833
2025-12-14 09:34:52 | INFO     | Epoch  13/200 | Train Loss: 1.0678 Acc: 0.5878 | Val Loss: 1.3738 Acc: 0.5572 F1: 0.3794
2025-12-14 09:34:52 | INFO     | Epoch  14/200 | Train Loss: 1.0709 Acc: 0.5899 | Val Loss: 1.2835 Acc: 0.6255 F1: 0.4202
2025-12-14 09:34:52 | INFO     | Epoch  15/200 | Train Loss: 1.0783 Acc: 0.6103 | Val Loss: 1.3621 Acc: 0.5649 F1: 0.3894
2025-12-14 09:34:52 | INFO     | Epoch  16/200 | Train Loss: 1.0527 Acc: 0.6011 | Val Loss: 1.6790 Acc: 0.5634 F1: 0.3856
2025-12-14 09:34:52 | INFO     | Epoch  17/200 | Train Loss: 1.0329 Acc: 0.6258 | Val Loss: 1.2238 Acc: 0.6030 F1: 0.4064
2025-12-14 09:34:52 | INFO     | Epoch  18/200 | Train Loss: 1.0303 Acc: 0.6114 | Val Loss: 1.2638 Acc: 0.6154 F1: 0.4133
2025-12-14 09:34:52 | INFO     | Epoch  19/200 | Train Loss: 1.0281 Acc: 0.5940 | Val Loss: 1.1004 Acc: 0.5974 F1: 0.2664
2025-12-14 09:34:52 | INFO     | Epoch  20/200 | Train Loss: 1.0086 Acc: 0.6207 | Val Loss: 1.3130 Acc: 0.5590 F1: 0.3799
2025-12-14 09:34:53 | INFO     | Epoch  21/200 | Train Loss: 1.0251 Acc: 0.6377 | Val Loss: 1.2799 Acc: 0.6033 F1: 0.4054
2025-12-14 09:34:53 | INFO     | Epoch  22/200 | Train Loss: 1.0086 Acc: 0.6256 | Val Loss: 1.2416 Acc: 0.5670 F1: 0.3625
2025-12-14 09:34:53 | INFO     | Epoch  23/200 | Train Loss: 1.0064 Acc: 0.6285 | Val Loss: 1.2779 Acc: 0.6115 F1: 0.4081
2025-12-14 09:34:53 | INFO     | Epoch  24/200 | Train Loss: 1.0379 Acc: 0.6368 | Val Loss: 1.3034 Acc: 0.5909 F1: 0.3983
2025-12-14 09:34:53 | INFO     | Epoch  25/200 | Train Loss: 1.0152 Acc: 0.6376 | Val Loss: 1.1774 Acc: 0.5871 F1: 0.3704
2025-12-14 09:34:53 | INFO     | Epoch  26/200 | Train Loss: 1.0453 Acc: 0.6084 | Val Loss: 1.3851 Acc: 0.6002 F1: 0.4048
2025-12-14 09:34:53 | INFO     | Epoch  27/200 | Train Loss: 1.0382 Acc: 0.6474 | Val Loss: 1.2674 Acc: 0.6167 F1: 0.4155
2025-12-14 09:34:54 | INFO     | Epoch  28/200 | Train Loss: 1.0327 Acc: 0.6298 | Val Loss: 1.2926 Acc: 0.6216 F1: 0.4152
2025-12-14 09:34:54 | INFO     | Epoch  29/200 | Train Loss: 1.0030 Acc: 0.6275 | Val Loss: 1.2205 Acc: 0.6097 F1: 0.4044
2025-12-14 09:34:54 | INFO     | Epoch  30/200 | Train Loss: 1.0256 Acc: 0.6405 | Val Loss: 1.2568 Acc: 0.6198 F1: 0.4115
2025-12-14 09:34:54 | INFO     | Epoch  31/200 | Train Loss: 1.0556 Acc: 0.6021 | Val Loss: 1.2193 Acc: 0.5814 F1: 0.3681
2025-12-14 09:34:54 | INFO     | Epoch  32/200 | Train Loss: 1.0459 Acc: 0.6266 | Val Loss: 1.2281 Acc: 0.6020 F1: 0.3789
2025-12-14 09:34:54 | INFO     | Early stopping at epoch 32
2025-12-14 09:34:54 | INFO     | 
============================================================
2025-12-14 09:34:54 | INFO     | EVALUATING HIERARCHICAL MODEL
2025-12-14 09:34:54 | INFO     | ============================================================
2025-12-14 09:34:54 | INFO     | Loaded Stage 1 (val F1: 0.5511)
2025-12-14 09:34:54 | INFO     | Loaded Stage 2 (val F1: 0.4260)
2025-12-14 09:34:54 | INFO     | 
----------------------------------------
2025-12-14 09:34:54 | INFO     | STAGE 1 RESULTS (Direction)
2025-12-14 09:34:54 | INFO     | ----------------------------------------
2025-12-14 09:34:54 | INFO     | 
              precision    recall  f1-score   support

        None       0.88      0.67      0.76      8821
     Bearish       0.20      0.53      0.29      1520
     Bullish       0.18      0.15      0.16      2203

    accuracy                           0.56     12544
   macro avg       0.42      0.45      0.40     12544
weighted avg       0.67      0.56      0.60     12544

2025-12-14 09:34:54 | INFO     | 
----------------------------------------
2025-12-14 09:34:54 | INFO     | STAGE 2 RESULTS (Subtype, pattern regions only)
2025-12-14 09:34:54 | INFO     | ----------------------------------------
2025-12-14 09:34:54 | INFO     | 
              precision    recall  f1-score   support

      Normal       0.56      0.73      0.63      2159
       Wedge       0.28      0.15      0.20      1184
     Pennant       0.21      0.16      0.19       380

    accuracy                           0.49      3723
   macro avg       0.35      0.35      0.34      3723
weighted avg       0.44      0.49      0.45      3723

2025-12-14 09:34:54 | INFO     | 
----------------------------------------
2025-12-14 09:34:54 | INFO     | COMBINED 7-CLASS RESULTS
2025-12-14 09:34:54 | INFO     | ----------------------------------------
2025-12-14 09:34:54 | INFO     | 
                 precision    recall  f1-score   support

           None       0.83      0.84      0.84      8821
 Bearish Normal       0.16      0.46      0.23       814
  Bearish Wedge       0.68      0.02      0.04       578
Bearish Pennant       0.00      0.00      0.00       128
 Bullish Normal       0.12      0.06      0.08      1345
  Bullish Wedge       0.00      0.00      0.00       606
Bullish Pennant       0.29      0.17      0.22       252

       accuracy                           0.63     12544
      macro avg       0.30      0.22      0.20     12544
   weighted avg       0.64      0.63      0.62     12544

2025-12-14 09:34:54 | INFO     | 
============================================================
2025-12-14 09:34:54 | INFO     | SEQUENCE LABELING METRICS
2025-12-14 09:34:54 | INFO     | ============================================================
