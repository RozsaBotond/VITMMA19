2025-12-14 09:41:48 | INFO     | ============================================================
2025-12-14 09:41:48 | INFO     | HIERARCHICAL CLASSIFICATION TRAINING
2025-12-14 09:41:48 | INFO     | ============================================================
2025-12-14 09:41:48 | INFO     | Data dir: data
2025-12-14 09:41:48 | INFO     | Save dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/models/hierarchical
2025-12-14 09:41:48 | INFO     | Device: cuda
2025-12-14 09:41:48 | INFO     | Loaded: 300 samples
2025-12-14 09:41:48 | INFO     | 
============================================================
2025-12-14 09:41:48 | INFO     | TRAINING STAGE 1: Direction Classifier
2025-12-14 09:41:48 | INFO     | ============================================================
2025-12-14 09:41:48 | INFO     | Train: 522 samples
2025-12-14 09:41:48 | INFO     | Val: 49 samples
2025-12-14 09:41:48 | INFO     | Train distribution:
2025-12-14 09:41:48 | INFO     |   None: 88861 (66.5%)
2025-12-14 09:41:48 | INFO     |   Bearish: 27778 (20.8%)
2025-12-14 09:41:48 | INFO     |   Bullish: 16993 (12.7%)
2025-12-14 09:41:48 | INFO     | Val distribution:
2025-12-14 09:41:48 | INFO     |   None: 8662 (69.1%)
2025-12-14 09:41:48 | INFO     |   Bearish: 2428 (19.4%)
2025-12-14 09:41:48 | INFO     |   Bullish: 1454 (11.6%)
2025-12-14 09:41:48 | INFO     | Class weights: [0.32612344622612, 1.0432592630386353, 1.6306172609329224]
2025-12-14 09:41:48 | INFO     | Model parameters: 533,251
2025-12-14 09:41:49 | INFO     | Epoch   1/300 | Train Loss: 1.2148 Acc: 0.3462 | Val Loss: 1.2004 Acc: 0.4564 F1: 0.2825
2025-12-14 09:41:49 | INFO     |   -> New best model saved (F1: 0.2825)
2025-12-14 09:41:50 | INFO     | Epoch   2/300 | Train Loss: 1.1999 Acc: 0.3953 | Val Loss: 1.1432 Acc: 0.4039 F1: 0.3724
2025-12-14 09:41:50 | INFO     |   -> New best model saved (F1: 0.3724)
2025-12-14 09:41:50 | INFO     | Epoch   3/300 | Train Loss: 1.1737 Acc: 0.4372 | Val Loss: 1.1466 Acc: 0.4787 F1: 0.3842
2025-12-14 09:41:50 | INFO     |   -> New best model saved (F1: 0.3842)
2025-12-14 09:41:50 | INFO     | Epoch   4/300 | Train Loss: 1.1625 Acc: 0.4227 | Val Loss: 1.1244 Acc: 0.5046 F1: 0.4301
2025-12-14 09:41:50 | INFO     |   -> New best model saved (F1: 0.4301)
2025-12-14 09:41:50 | INFO     | Epoch   5/300 | Train Loss: 1.1491 Acc: 0.4548 | Val Loss: 1.2112 Acc: 0.3174 F1: 0.3120
2025-12-14 09:41:51 | INFO     | Epoch   6/300 | Train Loss: 1.1460 Acc: 0.4365 | Val Loss: 1.1021 Acc: 0.6215 F1: 0.4635
2025-12-14 09:41:51 | INFO     |   -> New best model saved (F1: 0.4635)
2025-12-14 09:41:51 | INFO     | Epoch   7/300 | Train Loss: 1.1347 Acc: 0.4522 | Val Loss: 1.1573 Acc: 0.6594 F1: 0.4684
2025-12-14 09:41:51 | INFO     |   -> New best model saved (F1: 0.4684)
2025-12-14 09:41:51 | INFO     | Epoch   8/300 | Train Loss: 1.1184 Acc: 0.4485 | Val Loss: 1.0981 Acc: 0.5156 F1: 0.4262
2025-12-14 09:41:51 | INFO     | Epoch   9/300 | Train Loss: 1.1130 Acc: 0.5164 | Val Loss: 1.1074 Acc: 0.5321 F1: 0.3782
2025-12-14 09:41:52 | INFO     | Epoch  10/300 | Train Loss: 1.1127 Acc: 0.4669 | Val Loss: 1.1264 Acc: 0.6489 F1: 0.4772
2025-12-14 09:41:52 | INFO     |   -> New best model saved (F1: 0.4772)
2025-12-14 09:41:52 | INFO     | Epoch  11/300 | Train Loss: 1.1004 Acc: 0.5226 | Val Loss: 1.1294 Acc: 0.5791 F1: 0.4152
2025-12-14 09:41:52 | INFO     | Epoch  12/300 | Train Loss: 1.1042 Acc: 0.4948 | Val Loss: 1.1247 Acc: 0.6138 F1: 0.4124
2025-12-14 09:41:52 | INFO     | Epoch  13/300 | Train Loss: 1.1032 Acc: 0.5049 | Val Loss: 1.1070 Acc: 0.6426 F1: 0.4580
2025-12-14 09:41:53 | INFO     | Epoch  14/300 | Train Loss: 1.1068 Acc: 0.4909 | Val Loss: 1.0568 Acc: 0.6850 F1: 0.5044
2025-12-14 09:41:53 | INFO     |   -> New best model saved (F1: 0.5044)
2025-12-14 09:41:53 | INFO     | Epoch  15/300 | Train Loss: 1.1071 Acc: 0.5130 | Val Loss: 1.0771 Acc: 0.6067 F1: 0.4970
2025-12-14 09:41:53 | INFO     | Epoch  16/300 | Train Loss: 1.1062 Acc: 0.4814 | Val Loss: 1.1027 Acc: 0.5398 F1: 0.4370
2025-12-14 09:41:53 | INFO     | Epoch  17/300 | Train Loss: 1.0894 Acc: 0.4678 | Val Loss: 1.0916 Acc: 0.6968 F1: 0.4874
2025-12-14 09:41:54 | INFO     | Epoch  18/300 | Train Loss: 1.0959 Acc: 0.4936 | Val Loss: 1.1198 Acc: 0.5116 F1: 0.3702
2025-12-14 09:41:54 | INFO     | Epoch  19/300 | Train Loss: 1.0894 Acc: 0.5086 | Val Loss: 1.0769 Acc: 0.5592 F1: 0.4334
2025-12-14 09:41:54 | INFO     | Epoch  20/300 | Train Loss: 1.0750 Acc: 0.5297 | Val Loss: 1.0918 Acc: 0.6324 F1: 0.4698
2025-12-14 09:41:54 | INFO     | Epoch  21/300 | Train Loss: 1.0739 Acc: 0.4988 | Val Loss: 1.1153 Acc: 0.6597 F1: 0.4465
2025-12-14 09:41:55 | INFO     | Epoch  22/300 | Train Loss: 1.0836 Acc: 0.4977 | Val Loss: 1.1153 Acc: 0.6437 F1: 0.4629
2025-12-14 09:41:55 | INFO     | Epoch  23/300 | Train Loss: 1.0770 Acc: 0.5192 | Val Loss: 1.0793 Acc: 0.6829 F1: 0.5045
2025-12-14 09:41:55 | INFO     |   -> New best model saved (F1: 0.5045)
2025-12-14 09:41:55 | INFO     | Epoch  24/300 | Train Loss: 1.0625 Acc: 0.5381 | Val Loss: 1.0514 Acc: 0.6921 F1: 0.5415
2025-12-14 09:41:55 | INFO     |   -> New best model saved (F1: 0.5415)
2025-12-14 09:41:55 | INFO     | Epoch  25/300 | Train Loss: 1.0609 Acc: 0.5245 | Val Loss: 1.1307 Acc: 0.6154 F1: 0.4480
2025-12-14 09:41:55 | INFO     | Epoch  26/300 | Train Loss: 1.0609 Acc: 0.5153 | Val Loss: 1.0468 Acc: 0.6842 F1: 0.5523
2025-12-14 09:41:55 | INFO     |   -> New best model saved (F1: 0.5523)
2025-12-14 09:41:56 | INFO     | Epoch  27/300 | Train Loss: 1.0728 Acc: 0.5394 | Val Loss: 1.0998 Acc: 0.6307 F1: 0.4785
2025-12-14 09:41:56 | INFO     | Epoch  28/300 | Train Loss: 1.0646 Acc: 0.5348 | Val Loss: 1.0624 Acc: 0.5886 F1: 0.4680
2025-12-14 09:41:56 | INFO     | Epoch  29/300 | Train Loss: 1.0638 Acc: 0.5283 | Val Loss: 1.1388 Acc: 0.6758 F1: 0.4746
2025-12-14 09:41:56 | INFO     | Epoch  30/300 | Train Loss: 1.0562 Acc: 0.5440 | Val Loss: 1.0976 Acc: 0.5607 F1: 0.4454
2025-12-14 09:41:57 | INFO     | Epoch  31/300 | Train Loss: 1.0607 Acc: 0.5048 | Val Loss: 1.0931 Acc: 0.6027 F1: 0.4707
2025-12-14 09:41:57 | INFO     | Epoch  32/300 | Train Loss: 1.0566 Acc: 0.5496 | Val Loss: 1.0788 Acc: 0.6568 F1: 0.5058
2025-12-14 09:41:57 | INFO     | Epoch  33/300 | Train Loss: 1.0548 Acc: 0.5467 | Val Loss: 1.0795 Acc: 0.6468 F1: 0.5138
2025-12-14 09:41:57 | INFO     | Epoch  34/300 | Train Loss: 1.0686 Acc: 0.5497 | Val Loss: 1.0604 Acc: 0.6148 F1: 0.4846
2025-12-14 09:41:58 | INFO     | Epoch  35/300 | Train Loss: 1.0572 Acc: 0.5212 | Val Loss: 1.1063 Acc: 0.6189 F1: 0.4834
2025-12-14 09:41:58 | INFO     | Epoch  36/300 | Train Loss: 1.0612 Acc: 0.5153 | Val Loss: 1.0760 Acc: 0.6729 F1: 0.5001
2025-12-14 09:41:58 | INFO     | Epoch  37/300 | Train Loss: 1.0673 Acc: 0.5386 | Val Loss: 1.1230 Acc: 0.6839 F1: 0.5018
2025-12-14 09:41:58 | INFO     | Epoch  38/300 | Train Loss: 1.0546 Acc: 0.5674 | Val Loss: 1.0686 Acc: 0.6975 F1: 0.5300
2025-12-14 09:41:59 | INFO     | Epoch  39/300 | Train Loss: 1.0709 Acc: 0.5308 | Val Loss: 1.0841 Acc: 0.6069 F1: 0.4732
2025-12-14 09:41:59 | INFO     | Epoch  40/300 | Train Loss: 1.0601 Acc: 0.5183 | Val Loss: 1.1057 Acc: 0.7128 F1: 0.5179
2025-12-14 09:41:59 | INFO     | Epoch  41/300 | Train Loss: 1.0563 Acc: 0.5423 | Val Loss: 1.0986 Acc: 0.6579 F1: 0.5167
2025-12-14 09:41:59 | INFO     | Epoch  42/300 | Train Loss: 1.0585 Acc: 0.5617 | Val Loss: 1.0825 Acc: 0.6457 F1: 0.5042
2025-12-14 09:42:00 | INFO     | Epoch  43/300 | Train Loss: 1.0538 Acc: 0.5546 | Val Loss: 1.1110 Acc: 0.5831 F1: 0.4531
2025-12-14 09:42:00 | INFO     | Epoch  44/300 | Train Loss: 1.0486 Acc: 0.5291 | Val Loss: 1.0767 Acc: 0.6311 F1: 0.4609
2025-12-14 09:42:00 | INFO     | Epoch  45/300 | Train Loss: 1.0670 Acc: 0.5357 | Val Loss: 1.0818 Acc: 0.5608 F1: 0.4414
2025-12-14 09:42:00 | INFO     | Epoch  46/300 | Train Loss: 1.0559 Acc: 0.5234 | Val Loss: 1.0890 Acc: 0.5820 F1: 0.4630
2025-12-14 09:42:00 | INFO     | Epoch  47/300 | Train Loss: 1.0698 Acc: 0.5035 | Val Loss: 1.0955 Acc: 0.5804 F1: 0.4318
2025-12-14 09:42:01 | INFO     | Epoch  48/300 | Train Loss: 1.0445 Acc: 0.5538 | Val Loss: 1.1056 Acc: 0.6232 F1: 0.4798
2025-12-14 09:42:01 | INFO     | Epoch  49/300 | Train Loss: 1.0422 Acc: 0.5209 | Val Loss: 1.0770 Acc: 0.6730 F1: 0.5323
2025-12-14 09:42:01 | INFO     | Epoch  50/300 | Train Loss: 1.0435 Acc: 0.5375 | Val Loss: 1.0991 Acc: 0.6645 F1: 0.5171
2025-12-14 09:42:01 | INFO     | Epoch  51/300 | Train Loss: 1.0387 Acc: 0.5630 | Val Loss: 1.0968 Acc: 0.6372 F1: 0.4870
2025-12-14 09:42:02 | INFO     | Epoch  52/300 | Train Loss: 1.0351 Acc: 0.5464 | Val Loss: 1.1044 Acc: 0.7074 F1: 0.5289
2025-12-14 09:42:02 | INFO     | Epoch  53/300 | Train Loss: 1.0347 Acc: 0.5597 | Val Loss: 1.0718 Acc: 0.6779 F1: 0.5448
2025-12-14 09:42:02 | INFO     | Epoch  54/300 | Train Loss: 1.0561 Acc: 0.5506 | Val Loss: 1.1195 Acc: 0.5542 F1: 0.4539
2025-12-14 09:42:02 | INFO     | Epoch  55/300 | Train Loss: 1.0428 Acc: 0.5295 | Val Loss: 1.0466 Acc: 0.6118 F1: 0.4899
2025-12-14 09:42:03 | INFO     | Epoch  56/300 | Train Loss: 1.0318 Acc: 0.5607 | Val Loss: 1.0854 Acc: 0.7083 F1: 0.5281
2025-12-14 09:42:03 | INFO     | Epoch  57/300 | Train Loss: 1.0219 Acc: 0.5551 | Val Loss: 1.1610 Acc: 0.7102 F1: 0.5093
2025-12-14 09:42:03 | INFO     | Epoch  58/300 | Train Loss: 1.0165 Acc: 0.5651 | Val Loss: 1.1208 Acc: 0.6470 F1: 0.4994
2025-12-14 09:42:03 | INFO     | Epoch  59/300 | Train Loss: 1.0158 Acc: 0.5461 | Val Loss: 1.0933 Acc: 0.6732 F1: 0.5262
2025-12-14 09:42:04 | INFO     | Epoch  60/300 | Train Loss: 1.0126 Acc: 0.5713 | Val Loss: 1.0431 Acc: 0.7047 F1: 0.5473
2025-12-14 09:42:04 | INFO     | Epoch  61/300 | Train Loss: 1.0141 Acc: 0.5801 | Val Loss: 1.0639 Acc: 0.6559 F1: 0.5117
2025-12-14 09:42:04 | INFO     | Epoch  62/300 | Train Loss: 1.0220 Acc: 0.5717 | Val Loss: 1.1186 Acc: 0.6264 F1: 0.4957
2025-12-14 09:42:04 | INFO     | Epoch  63/300 | Train Loss: 1.0144 Acc: 0.5272 | Val Loss: 1.1110 Acc: 0.6456 F1: 0.4863
2025-12-14 09:42:05 | INFO     | Epoch  64/300 | Train Loss: 1.0135 Acc: 0.5700 | Val Loss: 1.0860 Acc: 0.6700 F1: 0.5365
2025-12-14 09:42:05 | INFO     | Epoch  65/300 | Train Loss: 1.0202 Acc: 0.5523 | Val Loss: 1.1232 Acc: 0.6439 F1: 0.5022
2025-12-14 09:42:05 | INFO     | Epoch  66/300 | Train Loss: 1.0213 Acc: 0.5648 | Val Loss: 1.0918 Acc: 0.6708 F1: 0.5227
2025-12-14 09:42:05 | INFO     | Epoch  67/300 | Train Loss: 1.0367 Acc: 0.5510 | Val Loss: 1.0799 Acc: 0.6423 F1: 0.5151
2025-12-14 09:42:05 | INFO     | Epoch  68/300 | Train Loss: 1.0346 Acc: 0.5753 | Val Loss: 1.0718 Acc: 0.6576 F1: 0.5172
2025-12-14 09:42:06 | INFO     | Epoch  69/300 | Train Loss: 1.0130 Acc: 0.5494 | Val Loss: 1.0839 Acc: 0.6885 F1: 0.5466
2025-12-14 09:42:06 | INFO     | Epoch  70/300 | Train Loss: 1.0357 Acc: 0.5571 | Val Loss: 1.1238 Acc: 0.6691 F1: 0.4764
2025-12-14 09:42:06 | INFO     | Epoch  71/300 | Train Loss: 1.0257 Acc: 0.5391 | Val Loss: 1.0876 Acc: 0.7112 F1: 0.5582
2025-12-14 09:42:06 | INFO     |   -> New best model saved (F1: 0.5582)
2025-12-14 09:42:06 | INFO     | Epoch  72/300 | Train Loss: 1.0270 Acc: 0.5474 | Val Loss: 1.0642 Acc: 0.6623 F1: 0.5298
2025-12-14 09:42:07 | INFO     | Epoch  73/300 | Train Loss: 1.0233 Acc: 0.5612 | Val Loss: 1.0930 Acc: 0.6264 F1: 0.4605
2025-12-14 09:42:07 | INFO     | Epoch  74/300 | Train Loss: 1.0238 Acc: 0.5645 | Val Loss: 1.0646 Acc: 0.6487 F1: 0.5117
2025-12-14 09:42:07 | INFO     | Epoch  75/300 | Train Loss: 1.0488 Acc: 0.5157 | Val Loss: 1.0886 Acc: 0.6040 F1: 0.4769
2025-12-14 09:42:07 | INFO     | Epoch  76/300 | Train Loss: 1.0249 Acc: 0.5662 | Val Loss: 1.0872 Acc: 0.6272 F1: 0.5081
2025-12-14 09:42:08 | INFO     | Epoch  77/300 | Train Loss: 1.0213 Acc: 0.5339 | Val Loss: 1.1178 Acc: 0.6954 F1: 0.5258
2025-12-14 09:42:08 | INFO     | Epoch  78/300 | Train Loss: 1.0139 Acc: 0.5360 | Val Loss: 1.0560 Acc: 0.6966 F1: 0.5561
2025-12-14 09:42:08 | INFO     | Epoch  79/300 | Train Loss: 1.0089 Acc: 0.5699 | Val Loss: 1.0774 Acc: 0.6900 F1: 0.5224
2025-12-14 09:42:08 | INFO     | Epoch  80/300 | Train Loss: 1.0051 Acc: 0.5734 | Val Loss: 1.1029 Acc: 0.6496 F1: 0.5105
2025-12-14 09:42:09 | INFO     | Epoch  81/300 | Train Loss: 1.0064 Acc: 0.5621 | Val Loss: 1.0584 Acc: 0.6566 F1: 0.5323
2025-12-14 09:42:09 | INFO     | Epoch  82/300 | Train Loss: 0.9979 Acc: 0.5712 | Val Loss: 1.0179 Acc: 0.6594 F1: 0.5448
2025-12-14 09:42:09 | INFO     | Epoch  83/300 | Train Loss: 1.0149 Acc: 0.5764 | Val Loss: 1.0475 Acc: 0.6599 F1: 0.5266
2025-12-14 09:42:09 | INFO     | Epoch  84/300 | Train Loss: 0.9975 Acc: 0.5804 | Val Loss: 1.0744 Acc: 0.6629 F1: 0.5133
2025-12-14 09:42:09 | INFO     | Epoch  85/300 | Train Loss: 1.0035 Acc: 0.5803 | Val Loss: 1.0631 Acc: 0.6810 F1: 0.5544
2025-12-14 09:42:10 | INFO     | Epoch  86/300 | Train Loss: 1.0250 Acc: 0.5425 | Val Loss: 1.0927 Acc: 0.6324 F1: 0.5045
2025-12-14 09:42:10 | INFO     | Epoch  87/300 | Train Loss: 1.0183 Acc: 0.5704 | Val Loss: 1.1008 Acc: 0.6886 F1: 0.5298
2025-12-14 09:42:10 | INFO     | Epoch  88/300 | Train Loss: 1.0184 Acc: 0.5564 | Val Loss: 1.0350 Acc: 0.6521 F1: 0.5393
2025-12-14 09:42:10 | INFO     | Epoch  89/300 | Train Loss: 1.0135 Acc: 0.5718 | Val Loss: 1.0943 Acc: 0.6474 F1: 0.5106
2025-12-14 09:42:11 | INFO     | Epoch  90/300 | Train Loss: 0.9936 Acc: 0.5799 | Val Loss: 1.0529 Acc: 0.6805 F1: 0.5487
2025-12-14 09:42:11 | INFO     | Epoch  91/300 | Train Loss: 0.9960 Acc: 0.5713 | Val Loss: 1.1270 Acc: 0.7017 F1: 0.5356
2025-12-14 09:42:11 | INFO     | Epoch  92/300 | Train Loss: 0.9952 Acc: 0.5739 | Val Loss: 1.0892 Acc: 0.6602 F1: 0.5271
2025-12-14 09:42:11 | INFO     | Epoch  93/300 | Train Loss: 0.9869 Acc: 0.5729 | Val Loss: 1.0758 Acc: 0.6724 F1: 0.5386
2025-12-14 09:42:12 | INFO     | Epoch  94/300 | Train Loss: 0.9976 Acc: 0.5782 | Val Loss: 1.1068 Acc: 0.6860 F1: 0.5379
2025-12-14 09:42:12 | INFO     | Epoch  95/300 | Train Loss: 0.9887 Acc: 0.6012 | Val Loss: 1.1152 Acc: 0.6510 F1: 0.5065
2025-12-14 09:42:12 | INFO     | Epoch  96/300 | Train Loss: 1.0177 Acc: 0.5789 | Val Loss: 1.0647 Acc: 0.6861 F1: 0.5360
2025-12-14 09:42:12 | INFO     | Epoch  97/300 | Train Loss: 1.0033 Acc: 0.5618 | Val Loss: 1.0554 Acc: 0.6562 F1: 0.5261
2025-12-14 09:42:13 | INFO     | Epoch  98/300 | Train Loss: 0.9983 Acc: 0.5670 | Val Loss: 1.0830 Acc: 0.6805 F1: 0.5309
2025-12-14 09:42:13 | INFO     | Epoch  99/300 | Train Loss: 0.9914 Acc: 0.5696 | Val Loss: 1.0994 Acc: 0.6433 F1: 0.5199
2025-12-14 09:42:13 | INFO     | Epoch 100/300 | Train Loss: 0.9975 Acc: 0.5588 | Val Loss: 1.1147 Acc: 0.5589 F1: 0.4594
2025-12-14 09:42:13 | INFO     | Epoch 101/300 | Train Loss: 1.0042 Acc: 0.5469 | Val Loss: 1.0975 Acc: 0.6537 F1: 0.5109
2025-12-14 09:42:14 | INFO     | Epoch 102/300 | Train Loss: 0.9949 Acc: 0.5726 | Val Loss: 1.0488 Acc: 0.6585 F1: 0.5300
2025-12-14 09:42:14 | INFO     | Epoch 103/300 | Train Loss: 0.9891 Acc: 0.5823 | Val Loss: 1.1391 Acc: 0.6492 F1: 0.5051
2025-12-14 09:42:14 | INFO     | Epoch 104/300 | Train Loss: 0.9799 Acc: 0.5684 | Val Loss: 1.1045 Acc: 0.6984 F1: 0.5298
2025-12-14 09:42:14 | INFO     | Epoch 105/300 | Train Loss: 0.9858 Acc: 0.5947 | Val Loss: 1.0923 Acc: 0.6971 F1: 0.5548
2025-12-14 09:42:14 | INFO     | Epoch 106/300 | Train Loss: 0.9942 Acc: 0.5684 | Val Loss: 1.0481 Acc: 0.6716 F1: 0.5532
2025-12-14 09:42:15 | INFO     | Epoch 107/300 | Train Loss: 0.9877 Acc: 0.5616 | Val Loss: 1.1123 Acc: 0.6757 F1: 0.5323
2025-12-14 09:42:15 | INFO     | Epoch 108/300 | Train Loss: 0.9938 Acc: 0.5855 | Val Loss: 1.0739 Acc: 0.7015 F1: 0.5512
2025-12-14 09:42:15 | INFO     | Epoch 109/300 | Train Loss: 0.9941 Acc: 0.5724 | Val Loss: 1.0524 Acc: 0.6299 F1: 0.5077
2025-12-14 09:42:15 | INFO     | Epoch 110/300 | Train Loss: 0.9797 Acc: 0.5762 | Val Loss: 1.0799 Acc: 0.6829 F1: 0.5406
2025-12-14 09:42:16 | INFO     | Epoch 111/300 | Train Loss: 0.9777 Acc: 0.5872 | Val Loss: 1.0807 Acc: 0.7024 F1: 0.5594
2025-12-14 09:42:16 | INFO     |   -> New best model saved (F1: 0.5594)
2025-12-14 09:42:16 | INFO     | Epoch 112/300 | Train Loss: 0.9997 Acc: 0.5932 | Val Loss: 1.0776 Acc: 0.6531 F1: 0.5419
2025-12-14 09:42:16 | INFO     | Epoch 113/300 | Train Loss: 0.9834 Acc: 0.5609 | Val Loss: 1.1131 Acc: 0.7086 F1: 0.5487
2025-12-14 09:42:16 | INFO     | Epoch 114/300 | Train Loss: 0.9760 Acc: 0.5910 | Val Loss: 1.0641 Acc: 0.7139 F1: 0.5465
2025-12-14 09:42:17 | INFO     | Epoch 115/300 | Train Loss: 0.9692 Acc: 0.5970 | Val Loss: 1.1186 Acc: 0.6678 F1: 0.5301
2025-12-14 09:42:17 | INFO     | Epoch 116/300 | Train Loss: 0.9742 Acc: 0.5925 | Val Loss: 1.1377 Acc: 0.6618 F1: 0.5104
2025-12-14 09:42:17 | INFO     | Epoch 117/300 | Train Loss: 0.9762 Acc: 0.5872 | Val Loss: 1.0888 Acc: 0.6463 F1: 0.5273
2025-12-14 09:42:17 | INFO     | Epoch 118/300 | Train Loss: 0.9782 Acc: 0.5812 | Val Loss: 1.1092 Acc: 0.6889 F1: 0.5342
2025-12-14 09:42:18 | INFO     | Epoch 119/300 | Train Loss: 0.9775 Acc: 0.5725 | Val Loss: 1.0937 Acc: 0.6791 F1: 0.5391
2025-12-14 09:42:18 | INFO     | Epoch 120/300 | Train Loss: 0.9814 Acc: 0.5847 | Val Loss: 1.0836 Acc: 0.6967 F1: 0.5513
2025-12-14 09:42:18 | INFO     | Epoch 121/300 | Train Loss: 0.9857 Acc: 0.5946 | Val Loss: 1.1456 Acc: 0.6084 F1: 0.4869
2025-12-14 09:42:18 | INFO     | Epoch 122/300 | Train Loss: 0.9695 Acc: 0.5867 | Val Loss: 1.0666 Acc: 0.6613 F1: 0.5258
2025-12-14 09:42:18 | INFO     | Epoch 123/300 | Train Loss: 0.9701 Acc: 0.5705 | Val Loss: 1.1250 Acc: 0.6422 F1: 0.4977
2025-12-14 09:42:19 | INFO     | Epoch 124/300 | Train Loss: 0.9884 Acc: 0.5811 | Val Loss: 1.0638 Acc: 0.6681 F1: 0.5168
2025-12-14 09:42:19 | INFO     | Epoch 125/300 | Train Loss: 0.9694 Acc: 0.5894 | Val Loss: 1.0770 Acc: 0.6159 F1: 0.4937
2025-12-14 09:42:19 | INFO     | Epoch 126/300 | Train Loss: 0.9683 Acc: 0.5949 | Val Loss: 1.0899 Acc: 0.6164 F1: 0.4927
2025-12-14 09:42:19 | INFO     | Epoch 127/300 | Train Loss: 0.9728 Acc: 0.5828 | Val Loss: 1.1062 Acc: 0.6648 F1: 0.5280
2025-12-14 09:42:20 | INFO     | Epoch 128/300 | Train Loss: 0.9735 Acc: 0.6075 | Val Loss: 1.0570 Acc: 0.6586 F1: 0.5380
2025-12-14 09:42:20 | INFO     | Epoch 129/300 | Train Loss: 0.9665 Acc: 0.5929 | Val Loss: 1.0589 Acc: 0.6809 F1: 0.5500
2025-12-14 09:42:20 | INFO     | Epoch 130/300 | Train Loss: 0.9664 Acc: 0.5823 | Val Loss: 1.0825 Acc: 0.6449 F1: 0.5185
2025-12-14 09:42:20 | INFO     | Epoch 131/300 | Train Loss: 0.9683 Acc: 0.5823 | Val Loss: 1.0884 Acc: 0.6637 F1: 0.5163
2025-12-14 09:42:21 | INFO     | Epoch 132/300 | Train Loss: 0.9657 Acc: 0.5974 | Val Loss: 1.1345 Acc: 0.6356 F1: 0.5089
2025-12-14 09:42:21 | INFO     | Epoch 133/300 | Train Loss: 0.9759 Acc: 0.5761 | Val Loss: 1.0538 Acc: 0.6515 F1: 0.5333
2025-12-14 09:42:21 | INFO     | Epoch 134/300 | Train Loss: 1.0102 Acc: 0.5963 | Val Loss: 1.0911 Acc: 0.6495 F1: 0.5095
2025-12-14 09:42:21 | INFO     | Epoch 135/300 | Train Loss: 0.9706 Acc: 0.5795 | Val Loss: 1.0616 Acc: 0.6976 F1: 0.5346
2025-12-14 09:42:22 | INFO     | Epoch 136/300 | Train Loss: 0.9586 Acc: 0.6009 | Val Loss: 1.1383 Acc: 0.6857 F1: 0.5334
2025-12-14 09:42:22 | INFO     | Epoch 137/300 | Train Loss: 0.9695 Acc: 0.5929 | Val Loss: 1.0451 Acc: 0.7050 F1: 0.5510
2025-12-14 09:42:22 | INFO     | Epoch 138/300 | Train Loss: 0.9551 Acc: 0.5988 | Val Loss: 1.0253 Acc: 0.7076 F1: 0.5598
2025-12-14 09:42:22 | INFO     |   -> New best model saved (F1: 0.5598)
2025-12-14 09:42:22 | INFO     | Epoch 139/300 | Train Loss: 0.9530 Acc: 0.5881 | Val Loss: 1.1004 Acc: 0.6872 F1: 0.5486
2025-12-14 09:42:22 | INFO     | Epoch 140/300 | Train Loss: 0.9569 Acc: 0.6045 | Val Loss: 1.0703 Acc: 0.6637 F1: 0.5437
2025-12-14 09:42:23 | INFO     | Epoch 141/300 | Train Loss: 0.9543 Acc: 0.5974 | Val Loss: 1.0628 Acc: 0.6653 F1: 0.5451
2025-12-14 09:42:23 | INFO     | Epoch 142/300 | Train Loss: 0.9558 Acc: 0.5916 | Val Loss: 1.0988 Acc: 0.6434 F1: 0.5184
2025-12-14 09:42:23 | INFO     | Epoch 143/300 | Train Loss: 0.9468 Acc: 0.6063 | Val Loss: 1.0303 Acc: 0.6969 F1: 0.5677
2025-12-14 09:42:23 | INFO     |   -> New best model saved (F1: 0.5677)
2025-12-14 09:42:23 | INFO     | Epoch 144/300 | Train Loss: 0.9454 Acc: 0.6225 | Val Loss: 1.0775 Acc: 0.6985 F1: 0.5672
2025-12-14 09:42:24 | INFO     | Epoch 145/300 | Train Loss: 0.9495 Acc: 0.6031 | Val Loss: 1.1005 Acc: 0.7153 F1: 0.5668
2025-12-14 09:42:24 | INFO     | Epoch 146/300 | Train Loss: 0.9520 Acc: 0.6049 | Val Loss: 1.0665 Acc: 0.6927 F1: 0.5568
2025-12-14 09:42:24 | INFO     | Epoch 147/300 | Train Loss: 0.9551 Acc: 0.6126 | Val Loss: 1.1208 Acc: 0.6893 F1: 0.5542
2025-12-14 09:42:24 | INFO     | Epoch 148/300 | Train Loss: 0.9490 Acc: 0.6010 | Val Loss: 1.0336 Acc: 0.7044 F1: 0.5742
2025-12-14 09:42:24 | INFO     |   -> New best model saved (F1: 0.5742)
2025-12-14 09:42:25 | INFO     | Epoch 149/300 | Train Loss: 0.9481 Acc: 0.5969 | Val Loss: 1.1235 Acc: 0.6719 F1: 0.5270
2025-12-14 09:42:25 | INFO     | Epoch 150/300 | Train Loss: 0.9537 Acc: 0.5947 | Val Loss: 1.0715 Acc: 0.7011 F1: 0.5652
2025-12-14 09:42:25 | INFO     | Epoch 151/300 | Train Loss: 0.9651 Acc: 0.6134 | Val Loss: 1.1241 Acc: 0.6876 F1: 0.5234
2025-12-14 09:42:25 | INFO     | Epoch 152/300 | Train Loss: 0.9574 Acc: 0.5862 | Val Loss: 1.0593 Acc: 0.6573 F1: 0.5324
2025-12-14 09:42:26 | INFO     | Epoch 153/300 | Train Loss: 0.9485 Acc: 0.6059 | Val Loss: 1.0546 Acc: 0.6788 F1: 0.5483
2025-12-14 09:42:26 | INFO     | Epoch 154/300 | Train Loss: 0.9387 Acc: 0.6024 | Val Loss: 1.0886 Acc: 0.6776 F1: 0.5480
2025-12-14 09:42:26 | INFO     | Epoch 155/300 | Train Loss: 0.9392 Acc: 0.6078 | Val Loss: 1.1054 Acc: 0.6553 F1: 0.5326
2025-12-14 09:42:26 | INFO     | Epoch 156/300 | Train Loss: 0.9423 Acc: 0.5977 | Val Loss: 1.1219 Acc: 0.6932 F1: 0.5545
2025-12-14 09:42:27 | INFO     | Epoch 157/300 | Train Loss: 0.9272 Acc: 0.6206 | Val Loss: 1.1000 Acc: 0.7056 F1: 0.5499
2025-12-14 09:42:27 | INFO     | Epoch 158/300 | Train Loss: 0.9516 Acc: 0.6132 | Val Loss: 1.1191 Acc: 0.6523 F1: 0.5174
2025-12-14 09:42:27 | INFO     | Epoch 159/300 | Train Loss: 0.9445 Acc: 0.6022 | Val Loss: 1.1635 Acc: 0.6545 F1: 0.5027
2025-12-14 09:42:27 | INFO     | Epoch 160/300 | Train Loss: 0.9469 Acc: 0.6063 | Val Loss: 1.1237 Acc: 0.6856 F1: 0.5450
2025-12-14 09:42:27 | INFO     | Epoch 161/300 | Train Loss: 0.9481 Acc: 0.5915 | Val Loss: 1.0544 Acc: 0.6717 F1: 0.5416
2025-12-14 09:42:28 | INFO     | Epoch 162/300 | Train Loss: 0.9320 Acc: 0.6185 | Val Loss: 1.1152 Acc: 0.6772 F1: 0.5389
2025-12-14 09:42:28 | INFO     | Epoch 163/300 | Train Loss: 0.9436 Acc: 0.6119 | Val Loss: 1.1245 Acc: 0.6712 F1: 0.5421
2025-12-14 09:42:28 | INFO     | Epoch 164/300 | Train Loss: 0.9392 Acc: 0.6200 | Val Loss: 1.1233 Acc: 0.6712 F1: 0.5147
2025-12-14 09:42:28 | INFO     | Epoch 165/300 | Train Loss: 0.9359 Acc: 0.5934 | Val Loss: 1.0585 Acc: 0.6921 F1: 0.5613
2025-12-14 09:42:29 | INFO     | Epoch 166/300 | Train Loss: 0.9351 Acc: 0.6085 | Val Loss: 1.0904 Acc: 0.6780 F1: 0.5529
2025-12-14 09:42:29 | INFO     | Epoch 167/300 | Train Loss: 0.9321 Acc: 0.6169 | Val Loss: 1.1376 Acc: 0.6559 F1: 0.5074
2025-12-14 09:42:29 | INFO     | Epoch 168/300 | Train Loss: 0.9259 Acc: 0.6197 | Val Loss: 1.1417 Acc: 0.6936 F1: 0.5447
2025-12-14 09:42:29 | INFO     | Epoch 169/300 | Train Loss: 0.9228 Acc: 0.6402 | Val Loss: 1.0941 Acc: 0.7132 F1: 0.5746
2025-12-14 09:42:29 | INFO     |   -> New best model saved (F1: 0.5746)
2025-12-14 09:42:30 | INFO     | Epoch 170/300 | Train Loss: 0.9284 Acc: 0.6219 | Val Loss: 1.1047 Acc: 0.7072 F1: 0.5707
2025-12-14 09:42:30 | INFO     | Epoch 171/300 | Train Loss: 0.9228 Acc: 0.6237 | Val Loss: 1.1382 Acc: 0.6995 F1: 0.5447
2025-12-14 09:42:30 | INFO     | Epoch 172/300 | Train Loss: 0.9202 Acc: 0.6239 | Val Loss: 1.1279 Acc: 0.6741 F1: 0.5454
2025-12-14 09:42:30 | INFO     | Epoch 173/300 | Train Loss: 0.9116 Acc: 0.6366 | Val Loss: 1.1150 Acc: 0.6863 F1: 0.5551
2025-12-14 09:42:31 | INFO     | Epoch 174/300 | Train Loss: 0.9243 Acc: 0.6155 | Val Loss: 1.0274 Acc: 0.6852 F1: 0.5618
2025-12-14 09:42:31 | INFO     | Epoch 175/300 | Train Loss: 0.9287 Acc: 0.6347 | Val Loss: 1.1422 Acc: 0.6601 F1: 0.5234
2025-12-14 09:42:31 | INFO     | Epoch 176/300 | Train Loss: 0.9135 Acc: 0.6312 | Val Loss: 1.1256 Acc: 0.6673 F1: 0.5191
2025-12-14 09:42:31 | INFO     | Epoch 177/300 | Train Loss: 0.9239 Acc: 0.6398 | Val Loss: 1.1585 Acc: 0.7031 F1: 0.5459
2025-12-14 09:42:31 | INFO     | Epoch 178/300 | Train Loss: 0.9194 Acc: 0.6345 | Val Loss: 1.0745 Acc: 0.7011 F1: 0.5709
2025-12-14 09:42:32 | INFO     | Epoch 179/300 | Train Loss: 0.9123 Acc: 0.6366 | Val Loss: 1.1251 Acc: 0.6714 F1: 0.5427
2025-12-14 09:42:32 | INFO     | Epoch 180/300 | Train Loss: 0.9113 Acc: 0.6390 | Val Loss: 1.1484 Acc: 0.6698 F1: 0.5356
2025-12-14 09:42:32 | INFO     | Epoch 181/300 | Train Loss: 0.9145 Acc: 0.6280 | Val Loss: 1.1128 Acc: 0.6743 F1: 0.5282
2025-12-14 09:42:32 | INFO     | Epoch 182/300 | Train Loss: 0.9025 Acc: 0.6419 | Val Loss: 1.0724 Acc: 0.6634 F1: 0.5257
2025-12-14 09:42:33 | INFO     | Epoch 183/300 | Train Loss: 0.9061 Acc: 0.6435 | Val Loss: 1.0866 Acc: 0.6991 F1: 0.5507
2025-12-14 09:42:33 | INFO     | Epoch 184/300 | Train Loss: 0.9014 Acc: 0.6494 | Val Loss: 1.0984 Acc: 0.7042 F1: 0.5632
2025-12-14 09:42:33 | INFO     | Epoch 185/300 | Train Loss: 0.9052 Acc: 0.6466 | Val Loss: 1.1426 Acc: 0.6888 F1: 0.5406
2025-12-14 09:42:33 | INFO     | Epoch 186/300 | Train Loss: 0.9038 Acc: 0.6497 | Val Loss: 1.1274 Acc: 0.6869 F1: 0.5468
2025-12-14 09:42:34 | INFO     | Epoch 187/300 | Train Loss: 0.9051 Acc: 0.6376 | Val Loss: 1.1080 Acc: 0.6582 F1: 0.5163
2025-12-14 09:42:34 | INFO     | Epoch 188/300 | Train Loss: 0.9041 Acc: 0.6310 | Val Loss: 1.0743 Acc: 0.6674 F1: 0.5423
2025-12-14 09:42:34 | INFO     | Epoch 189/300 | Train Loss: 0.9111 Acc: 0.6365 | Val Loss: 1.0918 Acc: 0.6638 F1: 0.5190
2025-12-14 09:42:34 | INFO     | Epoch 190/300 | Train Loss: 0.9062 Acc: 0.6322 | Val Loss: 1.0702 Acc: 0.6590 F1: 0.5204
2025-12-14 09:42:35 | INFO     | Epoch 191/300 | Train Loss: 0.9073 Acc: 0.6378 | Val Loss: 1.1209 Acc: 0.6593 F1: 0.5198
2025-12-14 09:42:35 | INFO     | Epoch 192/300 | Train Loss: 0.8964 Acc: 0.6382 | Val Loss: 1.1059 Acc: 0.6710 F1: 0.5345
2025-12-14 09:42:35 | INFO     | Epoch 193/300 | Train Loss: 0.8968 Acc: 0.6437 | Val Loss: 1.1641 Acc: 0.6713 F1: 0.5358
2025-12-14 09:42:35 | INFO     | Epoch 194/300 | Train Loss: 0.8918 Acc: 0.6573 | Val Loss: 1.1485 Acc: 0.6652 F1: 0.5164
2025-12-14 09:42:36 | INFO     | Epoch 195/300 | Train Loss: 0.8961 Acc: 0.6521 | Val Loss: 1.1546 Acc: 0.6747 F1: 0.5235
2025-12-14 09:42:36 | INFO     | Epoch 196/300 | Train Loss: 0.9060 Acc: 0.6414 | Val Loss: 1.1034 Acc: 0.6810 F1: 0.5493
2025-12-14 09:42:36 | INFO     | Epoch 197/300 | Train Loss: 0.8871 Acc: 0.6419 | Val Loss: 1.1150 Acc: 0.6834 F1: 0.5555
2025-12-14 09:42:36 | INFO     | Epoch 198/300 | Train Loss: 0.8969 Acc: 0.6413 | Val Loss: 1.1183 Acc: 0.6821 F1: 0.5475
2025-12-14 09:42:36 | INFO     | Epoch 199/300 | Train Loss: 0.8881 Acc: 0.6451 | Val Loss: 1.1601 Acc: 0.6515 F1: 0.4957
2025-12-14 09:42:37 | INFO     | Epoch 200/300 | Train Loss: 0.8844 Acc: 0.6506 | Val Loss: 1.1546 Acc: 0.6735 F1: 0.5256
2025-12-14 09:42:37 | INFO     | Epoch 201/300 | Train Loss: 0.9000 Acc: 0.6409 | Val Loss: 1.1524 Acc: 0.6719 F1: 0.5373
2025-12-14 09:42:37 | INFO     | Epoch 202/300 | Train Loss: 0.8827 Acc: 0.6540 | Val Loss: 1.1543 Acc: 0.6545 F1: 0.5195
2025-12-14 09:42:37 | INFO     | Epoch 203/300 | Train Loss: 0.8911 Acc: 0.6561 | Val Loss: 1.0971 Acc: 0.6848 F1: 0.5508
2025-12-14 09:42:38 | INFO     | Epoch 204/300 | Train Loss: 0.8805 Acc: 0.6530 | Val Loss: 1.1592 Acc: 0.6688 F1: 0.5208
2025-12-14 09:42:38 | INFO     | Epoch 205/300 | Train Loss: 0.8969 Acc: 0.6450 | Val Loss: 1.1345 Acc: 0.6733 F1: 0.5415
2025-12-14 09:42:38 | INFO     | Epoch 206/300 | Train Loss: 0.8897 Acc: 0.6587 | Val Loss: 1.1546 Acc: 0.6673 F1: 0.5198
2025-12-14 09:42:38 | INFO     | Epoch 207/300 | Train Loss: 0.8849 Acc: 0.6575 | Val Loss: 1.1467 Acc: 0.6789 F1: 0.5504
2025-12-14 09:42:39 | INFO     | Epoch 208/300 | Train Loss: 0.8781 Acc: 0.6610 | Val Loss: 1.0729 Acc: 0.6815 F1: 0.5450
2025-12-14 09:42:39 | INFO     | Epoch 209/300 | Train Loss: 0.8828 Acc: 0.6660 | Val Loss: 1.1467 Acc: 0.6410 F1: 0.5023
2025-12-14 09:42:39 | INFO     | Epoch 210/300 | Train Loss: 0.8715 Acc: 0.6609 | Val Loss: 1.1111 Acc: 0.6789 F1: 0.5313
2025-12-14 09:42:39 | INFO     | Epoch 211/300 | Train Loss: 0.8808 Acc: 0.6673 | Val Loss: 1.1277 Acc: 0.6764 F1: 0.5446
2025-12-14 09:42:40 | INFO     | Epoch 212/300 | Train Loss: 0.8729 Acc: 0.6600 | Val Loss: 1.1316 Acc: 0.6869 F1: 0.5512
2025-12-14 09:42:40 | INFO     | Epoch 213/300 | Train Loss: 0.8809 Acc: 0.6666 | Val Loss: 1.1286 Acc: 0.6781 F1: 0.5372
2025-12-14 09:42:40 | INFO     | Epoch 214/300 | Train Loss: 0.8850 Acc: 0.6698 | Val Loss: 1.1598 Acc: 0.6818 F1: 0.5416
2025-12-14 09:42:40 | INFO     | Epoch 215/300 | Train Loss: 0.8757 Acc: 0.6576 | Val Loss: 1.1176 Acc: 0.6729 F1: 0.5385
2025-12-14 09:42:40 | INFO     | Epoch 216/300 | Train Loss: 0.8821 Acc: 0.6643 | Val Loss: 1.1575 Acc: 0.6599 F1: 0.5207
2025-12-14 09:42:41 | INFO     | Epoch 217/300 | Train Loss: 0.8697 Acc: 0.6623 | Val Loss: 1.1901 Acc: 0.6589 F1: 0.5027
2025-12-14 09:42:41 | INFO     | Epoch 218/300 | Train Loss: 0.8716 Acc: 0.6633 | Val Loss: 1.1584 Acc: 0.6525 F1: 0.5094
2025-12-14 09:42:41 | INFO     | Epoch 219/300 | Train Loss: 0.8607 Acc: 0.6679 | Val Loss: 1.1510 Acc: 0.6677 F1: 0.5282
2025-12-14 09:42:41 | INFO     | Early stopping at epoch 219
2025-12-14 09:42:41 | INFO     | 
============================================================
2025-12-14 09:42:41 | INFO     | TRAINING STAGE 2: Subtype Classifier
2025-12-14 09:42:41 | INFO     | ============================================================
2025-12-14 09:42:41 | INFO     | Train: 522 samples, 44771 pattern timesteps
2025-12-14 09:42:41 | INFO     | Val: 49 samples, 3882 pattern timesteps
2025-12-14 09:42:41 | INFO     | Train subtype distribution (pattern regions):
2025-12-14 09:42:41 | INFO     |   Normal: 9627 (21.5%)
2025-12-14 09:42:41 | INFO     |   Wedge: 14402 (32.2%)
2025-12-14 09:42:41 | INFO     |   Pennant: 20742 (46.3%)
2025-12-14 09:42:41 | INFO     | Val subtype distribution (pattern regions):
2025-12-14 09:42:41 | INFO     |   Normal: 2543 (65.5%)
2025-12-14 09:42:41 | INFO     |   Wedge: 973 (25.1%)
2025-12-14 09:42:41 | INFO     |   Pennant: 366 (9.4%)
2025-12-14 09:42:41 | INFO     | Class weights: [1.550188660621643, 1.0362218618392944, 1.0]
2025-12-14 09:42:41 | INFO     | Model parameters: 533,251
2025-12-14 09:42:41 | INFO     | Using Focal Loss (gamma=2.0)
2025-12-14 09:42:42 | INFO     | Epoch   1/300 | Train Loss: 0.6922 Acc: 0.4420 | Val Loss: 0.8262 Acc: 0.3815 F1: 0.1928
2025-12-14 09:42:42 | INFO     |   -> New best model saved (F1: 0.1928)
2025-12-14 09:42:42 | INFO     | Epoch   2/300 | Train Loss: 0.6975 Acc: 0.4890 | Val Loss: 1.2990 Acc: 0.4758 F1: 0.3261
2025-12-14 09:42:42 | INFO     |   -> New best model saved (F1: 0.3261)
2025-12-14 09:42:42 | INFO     | Epoch   3/300 | Train Loss: 0.6456 Acc: 0.5260 | Val Loss: 0.7713 Acc: 0.5330 F1: 0.3490
2025-12-14 09:42:42 | INFO     |   -> New best model saved (F1: 0.3490)
2025-12-14 09:42:42 | INFO     | Epoch   4/300 | Train Loss: 0.6213 Acc: 0.5080 | Val Loss: 0.7443 Acc: 0.5904 F1: 0.3989
2025-12-14 09:42:42 | INFO     |   -> New best model saved (F1: 0.3989)
2025-12-14 09:42:43 | INFO     | Epoch   5/300 | Train Loss: 0.6262 Acc: 0.5228 | Val Loss: 0.7239 Acc: 0.5917 F1: 0.3896
2025-12-14 09:42:43 | INFO     | Epoch   6/300 | Train Loss: 0.6084 Acc: 0.5344 | Val Loss: 0.9103 Acc: 0.5240 F1: 0.3942
2025-12-14 09:42:43 | INFO     | Epoch   7/300 | Train Loss: 0.6360 Acc: 0.5303 | Val Loss: 0.6665 Acc: 0.5744 F1: 0.3007
2025-12-14 09:42:43 | INFO     | Epoch   8/300 | Train Loss: 0.6306 Acc: 0.5216 | Val Loss: 0.6584 Acc: 0.5971 F1: 0.3845
2025-12-14 09:42:44 | INFO     | Epoch   9/300 | Train Loss: 0.5878 Acc: 0.5510 | Val Loss: 0.6748 Acc: 0.6218 F1: 0.4161
2025-12-14 09:42:44 | INFO     |   -> New best model saved (F1: 0.4161)
2025-12-14 09:42:44 | INFO     | Epoch  10/300 | Train Loss: 0.5825 Acc: 0.5424 | Val Loss: 0.6559 Acc: 0.5824 F1: 0.2979
2025-12-14 09:42:44 | INFO     | Epoch  11/300 | Train Loss: 0.5796 Acc: 0.5404 | Val Loss: 0.5961 Acc: 0.6157 F1: 0.2994
2025-12-14 09:42:44 | INFO     | Epoch  12/300 | Train Loss: 0.6062 Acc: 0.5341 | Val Loss: 0.6541 Acc: 0.5732 F1: 0.3819
2025-12-14 09:42:45 | INFO     | Epoch  13/300 | Train Loss: 0.6119 Acc: 0.5502 | Val Loss: 0.8651 Acc: 0.5824 F1: 0.4963
2025-12-14 09:42:45 | INFO     |   -> New best model saved (F1: 0.4963)
2025-12-14 09:42:45 | INFO     | Epoch  14/300 | Train Loss: 0.5486 Acc: 0.5776 | Val Loss: 0.9376 Acc: 0.5131 F1: 0.4127
2025-12-14 09:42:45 | INFO     | Epoch  15/300 | Train Loss: 0.5825 Acc: 0.5660 | Val Loss: 0.7832 Acc: 0.5801 F1: 0.3976
2025-12-14 09:42:45 | INFO     | Epoch  16/300 | Train Loss: 0.5771 Acc: 0.5444 | Val Loss: 0.7074 Acc: 0.6108 F1: 0.4104
2025-12-14 09:42:46 | INFO     | Epoch  17/300 | Train Loss: 0.5803 Acc: 0.5553 | Val Loss: 0.6418 Acc: 0.6010 F1: 0.3781
2025-12-14 09:42:46 | INFO     | Epoch  18/300 | Train Loss: 0.5557 Acc: 0.5568 | Val Loss: 0.6069 Acc: 0.6113 F1: 0.4067
2025-12-14 09:42:46 | INFO     | Epoch  19/300 | Train Loss: 0.5840 Acc: 0.5782 | Val Loss: 0.6627 Acc: 0.5786 F1: 0.4259
2025-12-14 09:42:46 | INFO     | Epoch  20/300 | Train Loss: 0.5383 Acc: 0.5730 | Val Loss: 0.6931 Acc: 0.6167 F1: 0.4125
2025-12-14 09:42:47 | INFO     | Epoch  21/300 | Train Loss: 0.5590 Acc: 0.5898 | Val Loss: 0.6424 Acc: 0.6159 F1: 0.4646
2025-12-14 09:42:47 | INFO     | Epoch  22/300 | Train Loss: 0.5330 Acc: 0.5531 | Val Loss: 0.9030 Acc: 0.5422 F1: 0.4482
2025-12-14 09:42:47 | INFO     | Epoch  23/300 | Train Loss: 0.5669 Acc: 0.5666 | Val Loss: 0.6162 Acc: 0.6025 F1: 0.4009
2025-12-14 09:42:47 | INFO     | Epoch  24/300 | Train Loss: 0.5493 Acc: 0.5704 | Val Loss: 0.6805 Acc: 0.5726 F1: 0.4487
2025-12-14 09:42:48 | INFO     | Epoch  25/300 | Train Loss: 0.5257 Acc: 0.5747 | Val Loss: 0.7072 Acc: 0.6190 F1: 0.4112
2025-12-14 09:42:48 | INFO     | Epoch  26/300 | Train Loss: 0.5296 Acc: 0.5867 | Val Loss: 0.5992 Acc: 0.5835 F1: 0.3240
2025-12-14 09:42:48 | INFO     | Epoch  27/300 | Train Loss: 0.5233 Acc: 0.5959 | Val Loss: 0.5946 Acc: 0.6252 F1: 0.4257
2025-12-14 09:42:48 | INFO     | Epoch  28/300 | Train Loss: 0.5290 Acc: 0.5995 | Val Loss: 0.6838 Acc: 0.6198 F1: 0.4900
2025-12-14 09:42:49 | INFO     | Epoch  29/300 | Train Loss: 0.5202 Acc: 0.5869 | Val Loss: 0.6913 Acc: 0.6229 F1: 0.4360
2025-12-14 09:42:49 | INFO     | Epoch  30/300 | Train Loss: 0.5225 Acc: 0.5928 | Val Loss: 0.7019 Acc: 0.6020 F1: 0.4006
2025-12-14 09:42:49 | INFO     | Epoch  31/300 | Train Loss: 0.5414 Acc: 0.5930 | Val Loss: 0.5598 Acc: 0.6321 F1: 0.3751
2025-12-14 09:42:49 | INFO     | Epoch  32/300 | Train Loss: 0.5695 Acc: 0.5430 | Val Loss: 0.7470 Acc: 0.6074 F1: 0.4232
2025-12-14 09:42:50 | INFO     | Epoch  33/300 | Train Loss: 0.5319 Acc: 0.5818 | Val Loss: 0.6771 Acc: 0.6082 F1: 0.4053
2025-12-14 09:42:50 | INFO     | Epoch  34/300 | Train Loss: 0.5199 Acc: 0.6138 | Val Loss: 0.5298 Acc: 0.6092 F1: 0.3555
2025-12-14 09:42:50 | INFO     | Epoch  35/300 | Train Loss: 0.5235 Acc: 0.5939 | Val Loss: 0.6421 Acc: 0.5909 F1: 0.3949
2025-12-14 09:42:51 | INFO     | Epoch  36/300 | Train Loss: 0.5163 Acc: 0.6118 | Val Loss: 0.5985 Acc: 0.6399 F1: 0.3811
2025-12-14 09:42:51 | INFO     | Epoch  37/300 | Train Loss: 0.5138 Acc: 0.6002 | Val Loss: 0.6900 Acc: 0.5966 F1: 0.4249
2025-12-14 09:42:51 | INFO     | Epoch  38/300 | Train Loss: 0.5343 Acc: 0.6120 | Val Loss: 0.6897 Acc: 0.6128 F1: 0.3667
2025-12-14 09:42:51 | INFO     | Epoch  39/300 | Train Loss: 0.5161 Acc: 0.6027 | Val Loss: 0.8904 Acc: 0.5750 F1: 0.3987
2025-12-14 09:42:52 | INFO     | Epoch  40/300 | Train Loss: 0.5146 Acc: 0.6051 | Val Loss: 0.6396 Acc: 0.6002 F1: 0.3813
2025-12-14 09:42:52 | INFO     | Epoch  41/300 | Train Loss: 0.5180 Acc: 0.5904 | Val Loss: 0.6051 Acc: 0.5796 F1: 0.3903
2025-12-14 09:42:52 | INFO     | Epoch  42/300 | Train Loss: 0.5864 Acc: 0.5927 | Val Loss: 0.6903 Acc: 0.6412 F1: 0.4068
2025-12-14 09:42:52 | INFO     | Epoch  43/300 | Train Loss: 0.5038 Acc: 0.6330 | Val Loss: 0.6609 Acc: 0.6030 F1: 0.3697
2025-12-14 09:42:53 | INFO     | Epoch  44/300 | Train Loss: 0.5288 Acc: 0.6088 | Val Loss: 0.8240 Acc: 0.5518 F1: 0.3928
2025-12-14 09:42:53 | INFO     | Epoch  45/300 | Train Loss: 0.5144 Acc: 0.6292 | Val Loss: 0.6666 Acc: 0.6190 F1: 0.3757
2025-12-14 09:42:53 | INFO     | Epoch  46/300 | Train Loss: 0.5126 Acc: 0.6356 | Val Loss: 0.5711 Acc: 0.6103 F1: 0.3768
2025-12-14 09:42:53 | INFO     | Epoch  47/300 | Train Loss: 0.5149 Acc: 0.5954 | Val Loss: 0.6686 Acc: 0.6293 F1: 0.4694
2025-12-14 09:42:54 | INFO     | Epoch  48/300 | Train Loss: 0.5210 Acc: 0.6353 | Val Loss: 0.5643 Acc: 0.6546 F1: 0.3519
2025-12-14 09:42:54 | INFO     | Epoch  49/300 | Train Loss: 0.5017 Acc: 0.6088 | Val Loss: 0.5869 Acc: 0.6453 F1: 0.3833
2025-12-14 09:42:54 | INFO     | Epoch  50/300 | Train Loss: 0.5098 Acc: 0.6318 | Val Loss: 0.6281 Acc: 0.6218 F1: 0.3858
2025-12-14 09:42:54 | INFO     | Epoch  51/300 | Train Loss: 0.4807 Acc: 0.6327 | Val Loss: 0.6178 Acc: 0.6471 F1: 0.3894
2025-12-14 09:42:55 | INFO     | Epoch  52/300 | Train Loss: 0.4852 Acc: 0.6271 | Val Loss: 0.6314 Acc: 0.6208 F1: 0.3567
2025-12-14 09:42:55 | INFO     | Epoch  53/300 | Train Loss: 0.4912 Acc: 0.6443 | Val Loss: 0.7408 Acc: 0.6167 F1: 0.3974
2025-12-14 09:42:55 | INFO     | Epoch  54/300 | Train Loss: 0.5194 Acc: 0.6051 | Val Loss: 0.6148 Acc: 0.6061 F1: 0.3532
2025-12-14 09:42:55 | INFO     | Epoch  55/300 | Train Loss: 0.4947 Acc: 0.6284 | Val Loss: 0.6110 Acc: 0.6149 F1: 0.3805
2025-12-14 09:42:56 | INFO     | Epoch  56/300 | Train Loss: 0.4928 Acc: 0.6112 | Val Loss: 0.5989 Acc: 0.6378 F1: 0.4012
2025-12-14 09:42:56 | INFO     | Epoch  57/300 | Train Loss: 0.4756 Acc: 0.6479 | Val Loss: 0.6231 Acc: 0.6255 F1: 0.4050
2025-12-14 09:42:56 | INFO     | Epoch  58/300 | Train Loss: 0.4836 Acc: 0.6369 | Val Loss: 0.6139 Acc: 0.6360 F1: 0.3982
2025-12-14 09:42:56 | INFO     | Epoch  59/300 | Train Loss: 0.4990 Acc: 0.6486 | Val Loss: 0.6511 Acc: 0.5659 F1: 0.3566
2025-12-14 09:42:57 | INFO     | Epoch  60/300 | Train Loss: 0.4849 Acc: 0.6497 | Val Loss: 0.6190 Acc: 0.6484 F1: 0.4051
2025-12-14 09:42:57 | INFO     | Epoch  61/300 | Train Loss: 0.4886 Acc: 0.6456 | Val Loss: 0.6416 Acc: 0.5582 F1: 0.3485
2025-12-14 09:42:57 | INFO     | Epoch  62/300 | Train Loss: 0.4952 Acc: 0.6326 | Val Loss: 0.6186 Acc: 0.6159 F1: 0.3897
2025-12-14 09:42:58 | INFO     | Epoch  63/300 | Train Loss: 0.5022 Acc: 0.6202 | Val Loss: 0.6241 Acc: 0.6121 F1: 0.3829
2025-12-14 09:42:58 | INFO     | Early stopping at epoch 63
2025-12-14 09:42:58 | INFO     | 
============================================================
2025-12-14 09:42:58 | INFO     | EVALUATING HIERARCHICAL MODEL
2025-12-14 09:42:58 | INFO     | ============================================================
2025-12-14 09:42:58 | INFO     | Loaded Stage 1 (val F1: 0.5746)
2025-12-14 09:42:58 | INFO     | Loaded Stage 2 (val F1: 0.4963)
2025-12-14 09:42:58 | INFO     | 
----------------------------------------
2025-12-14 09:42:58 | INFO     | STAGE 1 RESULTS (Direction)
2025-12-14 09:42:58 | INFO     | ----------------------------------------
2025-12-14 09:42:58 | INFO     | 
              precision    recall  f1-score   support

        None       0.89      0.71      0.79      8821
     Bearish       0.32      0.74      0.45      1520
     Bullish       0.18      0.17      0.18      2203

    accuracy                           0.62     12544
   macro avg       0.47      0.54      0.47     12544
weighted avg       0.70      0.62      0.64     12544

2025-12-14 09:42:58 | INFO     | 
----------------------------------------
2025-12-14 09:42:58 | INFO     | STAGE 2 RESULTS (Subtype, pattern regions only)
2025-12-14 09:42:58 | INFO     | ----------------------------------------
2025-12-14 09:42:58 | INFO     | 
              precision    recall  f1-score   support

      Normal       0.55      0.69      0.61      2159
       Wedge       0.37      0.18      0.24      1184
     Pennant       0.00      0.00      0.00       380

    accuracy                           0.46      3723
   macro avg       0.31      0.29      0.29      3723
weighted avg       0.44      0.46      0.43      3723

2025-12-14 09:42:58 | INFO     | 
----------------------------------------
2025-12-14 09:42:58 | INFO     | COMBINED 7-CLASS RESULTS
2025-12-14 09:42:58 | INFO     | ----------------------------------------
2025-12-14 09:42:58 | INFO     | 
                 precision    recall  f1-score   support

           None       0.88      0.88      0.88      8821
 Bearish Normal       0.15      0.36      0.21       814
  Bearish Wedge       0.09      0.05      0.06       578
Bearish Pennant       0.00      0.00      0.00       128
 Bullish Normal       0.16      0.12      0.13      1345
  Bullish Wedge       0.00      0.00      0.00       606
Bullish Pennant       0.00      0.00      0.00       252

       accuracy                           0.66     12544
      macro avg       0.18      0.20      0.18     12544
   weighted avg       0.65      0.66      0.65     12544

2025-12-14 09:42:58 | INFO     | 
============================================================
2025-12-14 09:42:58 | INFO     | SEQUENCE LABELING METRICS
2025-12-14 09:42:58 | INFO     | ============================================================
2025-12-14 09:42:58 | INFO     | 
Accuracy:         0.6551
2025-12-14 09:42:58 | INFO     | F1 (macro):       0.1833
2025-12-14 09:42:58 | INFO     | Detection Rate:   0.8163
2025-12-14 09:42:58 | INFO     | False Alarm Rate: 0.0517
2025-12-14 09:42:58 | INFO     | 
============================================================
2025-12-14 09:42:58 | INFO     | TRAINING COMPLETE
2025-12-14 09:42:58 | INFO     | ============================================================
