2025-12-14 08:33:19 | INFO     | Model: seq_lstm
2025-12-14 08:33:19 | INFO     | Mode: 7class (7 classes)
2025-12-14 08:33:19 | INFO     | Data dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/data
2025-12-14 08:33:19 | INFO     | Save dir: /home/rozsa/Dokumentumok/egyetem/msc/VITMMA19/models/seq_lstm
2025-12-14 08:33:19 | INFO     | Device: cuda
2025-12-14 08:33:19 | INFO     | Loaded pre-split data:
2025-12-14 08:33:19 | INFO     |   Train: (481, 256, 4) (may be augmented)
2025-12-14 08:33:19 | INFO     |   Val:   (42, 256, 4) (original)
2025-12-14 08:33:19 | INFO     |   Test:  (42, 256, 4) (original)
2025-12-14 08:33:19 | INFO     | Class names: ['None', 'Bearish Normal', 'Bearish Wedge', 'Bearish Pennant', 'Bullish Normal', 'Bullish Wedge', 'Bullish Pennant']
2025-12-14 08:33:19 | INFO     | Balanced: True
2025-12-14 08:33:19 | INFO     | Training label distribution:
2025-12-14 08:33:19 | INFO     |   None: 78455 (63.7%)
2025-12-14 08:33:19 | INFO     |   Bearish Normal: 4441 (3.6%)
2025-12-14 08:33:19 | INFO     |   Bearish Wedge: 7151 (5.8%)
2025-12-14 08:33:19 | INFO     |   Bearish Pennant: 10787 (8.8%)
2025-12-14 08:33:19 | INFO     |   Bullish Normal: 5816 (4.7%)
2025-12-14 08:33:19 | INFO     |   Bullish Wedge: 7670 (6.2%)
2025-12-14 08:33:19 | INFO     |   Bullish Pennant: 8816 (7.2%)
2025-12-14 08:33:19 | INFO     | Config: {'input_size': 4, 'hidden_size': 128, 'num_layers': 2, 'num_classes': 7, 'dropout': 0.2, 'bidirectional': False, 'learning_rate': 0.001, 'batch_size': 16, 'epochs': 100, 'weight_decay': 1e-05, 'use_class_weights': True, 'max_class_weight': 10.0, 'patience': 20, 'min_delta': 0.0001, 'scheduler': 'cosine', 'warmup_epochs': 5, 'label_smoothing': 0.05, 'focal_loss': False, 'focal_gamma': 2.0, 'name': 'seq_lstm', 'description': 'LSTM for per-timestep sequence labeling', 'mode': '7class'}
2025-12-14 08:33:19 | INFO     | Train: 481 samples
2025-12-14 08:33:19 | INFO     | Val:   42 samples
2025-12-14 08:33:19 | INFO     | Test:  42 samples
2025-12-14 08:33:19 | INFO     | Class weights (balanced): [0.12243697792291641, 1.224369764328003, 1.224369764328003, 0.8904972076416016, 1.224369764328003, 1.224369764328003, 1.0895862579345703]
2025-12-14 08:33:19 | INFO     | Model parameters: 201,607
2025-12-14 08:33:20 | INFO     | ============================================================
2025-12-14 08:33:20 | INFO     | TRAINING STARTED
2025-12-14 08:33:20 | INFO     | ============================================================
2025-12-14 08:33:20 | INFO     | Epoch   1/100 | Train Loss: 2.0177 Acc: 0.2248 | Val Loss: 2.2929 Acc: 0.1012 F1: 0.0428 | LR: 1.00e-03
2025-12-14 08:33:20 | INFO     |   -> New best model saved (F1: 0.0428)
2025-12-14 08:33:21 | INFO     | Epoch   2/100 | Train Loss: 1.9936 Acc: 0.2275 | Val Loss: 2.1050 Acc: 0.1311 F1: 0.0431 | LR: 9.99e-04
2025-12-14 08:33:21 | INFO     |   -> New best model saved (F1: 0.0431)
2025-12-14 08:33:21 | INFO     | Epoch   3/100 | Train Loss: 1.9698 Acc: 0.2335 | Val Loss: 2.1033 Acc: 0.2243 F1: 0.0680 | LR: 9.98e-04
2025-12-14 08:33:21 | INFO     |   -> New best model saved (F1: 0.0680)
2025-12-14 08:33:21 | INFO     | Epoch   4/100 | Train Loss: 2.0238 Acc: 0.1940 | Val Loss: 2.2744 Acc: 0.2877 F1: 0.0814 | LR: 9.96e-04
2025-12-14 08:33:21 | INFO     |   -> New best model saved (F1: 0.0814)
2025-12-14 08:33:21 | INFO     | Epoch   5/100 | Train Loss: 2.0138 Acc: 0.1836 | Val Loss: 2.0623 Acc: 0.0382 F1: 0.0187 | LR: 9.94e-04
2025-12-14 08:33:21 | INFO     | Epoch   6/100 | Train Loss: 1.9637 Acc: 0.2550 | Val Loss: 2.1293 Acc: 0.1041 F1: 0.0354 | LR: 9.91e-04
2025-12-14 08:33:22 | INFO     | Epoch   7/100 | Train Loss: 1.9253 Acc: 0.2716 | Val Loss: 2.0222 Acc: 0.2255 F1: 0.0684 | LR: 9.88e-04
2025-12-14 08:33:22 | INFO     | Epoch   8/100 | Train Loss: 1.9473 Acc: 0.3169 | Val Loss: 2.0739 Acc: 0.1709 F1: 0.0548 | LR: 9.84e-04
2025-12-14 08:33:22 | INFO     | Epoch   9/100 | Train Loss: 1.9402 Acc: 0.2118 | Val Loss: 2.0520 Acc: 0.2910 F1: 0.0812 | LR: 9.80e-04
2025-12-14 08:33:22 | INFO     | Epoch  10/100 | Train Loss: 1.9264 Acc: 0.2557 | Val Loss: 2.0285 Acc: 0.1335 F1: 0.0444 | LR: 9.76e-04
2025-12-14 08:33:22 | INFO     | Epoch  11/100 | Train Loss: 1.9416 Acc: 0.2660 | Val Loss: 2.0860 Acc: 0.3153 F1: 0.0878 | LR: 9.70e-04
2025-12-14 08:33:22 | INFO     |   -> New best model saved (F1: 0.0878)
2025-12-14 08:33:22 | INFO     | Epoch  12/100 | Train Loss: 1.9263 Acc: 0.3531 | Val Loss: 2.0326 Acc: 0.3777 F1: 0.0914 | LR: 9.65e-04
2025-12-14 08:33:22 | INFO     |   -> New best model saved (F1: 0.0914)
2025-12-14 08:33:23 | INFO     | Epoch  13/100 | Train Loss: 1.9281 Acc: 0.2935 | Val Loss: 2.0444 Acc: 0.2892 F1: 0.0803 | LR: 9.59e-04
2025-12-14 08:33:23 | INFO     | Epoch  14/100 | Train Loss: 1.9190 Acc: 0.2045 | Val Loss: 1.9578 Acc: 0.6605 F1: 0.1146 | LR: 9.52e-04
2025-12-14 08:33:23 | INFO     |   -> New best model saved (F1: 0.1146)
2025-12-14 08:33:23 | INFO     | Epoch  15/100 | Train Loss: 1.9039 Acc: 0.3669 | Val Loss: 1.9836 Acc: 0.3506 F1: 0.0955 | LR: 9.46e-04
2025-12-14 08:33:23 | INFO     | Epoch  16/100 | Train Loss: 1.9232 Acc: 0.3054 | Val Loss: 2.0536 Acc: 0.2299 F1: 0.0691 | LR: 9.38e-04
2025-12-14 08:33:23 | INFO     | Epoch  17/100 | Train Loss: 1.9200 Acc: 0.2552 | Val Loss: 2.0335 Acc: 0.3058 F1: 0.0814 | LR: 9.30e-04
2025-12-14 08:33:23 | INFO     | Epoch  18/100 | Train Loss: 1.9176 Acc: 0.3202 | Val Loss: 2.0013 Acc: 0.3051 F1: 0.0806 | LR: 9.22e-04
2025-12-14 08:33:24 | INFO     | Epoch  19/100 | Train Loss: 1.8990 Acc: 0.3471 | Val Loss: 2.0048 Acc: 0.2345 F1: 0.0680 | LR: 9.14e-04
2025-12-14 08:33:24 | INFO     | Epoch  20/100 | Train Loss: 1.8838 Acc: 0.3524 | Val Loss: 1.9998 Acc: 0.2473 F1: 0.0715 | LR: 9.05e-04
2025-12-14 08:33:24 | INFO     | Epoch  21/100 | Train Loss: 1.8852 Acc: 0.2573 | Val Loss: 2.0389 Acc: 0.2462 F1: 0.0842 | LR: 8.95e-04
2025-12-14 08:33:24 | INFO     | Epoch  22/100 | Train Loss: 1.9118 Acc: 0.2476 | Val Loss: 1.9942 Acc: 0.3086 F1: 0.0930 | LR: 8.85e-04
2025-12-14 08:33:24 | INFO     | Epoch  23/100 | Train Loss: 1.9168 Acc: 0.3157 | Val Loss: 1.9966 Acc: 0.3185 F1: 0.0974 | LR: 8.75e-04
2025-12-14 08:33:24 | INFO     | Epoch  24/100 | Train Loss: 1.8980 Acc: 0.3223 | Val Loss: 2.0589 Acc: 0.1561 F1: 0.0695 | LR: 8.65e-04
2025-12-14 08:33:25 | INFO     | Epoch  25/100 | Train Loss: 1.8952 Acc: 0.2259 | Val Loss: 2.0002 Acc: 0.2520 F1: 0.0776 | LR: 8.54e-04
2025-12-14 08:33:25 | INFO     | Epoch  26/100 | Train Loss: 1.8987 Acc: 0.3600 | Val Loss: 1.9820 Acc: 0.3273 F1: 0.0884 | LR: 8.42e-04
2025-12-14 08:33:25 | INFO     | Epoch  27/100 | Train Loss: 1.8886 Acc: 0.3571 | Val Loss: 2.0034 Acc: 0.3178 F1: 0.0909 | LR: 8.31e-04
2025-12-14 08:33:25 | INFO     | Epoch  28/100 | Train Loss: 1.8802 Acc: 0.3740 | Val Loss: 2.0232 Acc: 0.2885 F1: 0.0740 | LR: 8.19e-04
2025-12-14 08:33:25 | INFO     | Epoch  29/100 | Train Loss: 1.8834 Acc: 0.2513 | Val Loss: 2.1228 Acc: 0.1281 F1: 0.0484 | LR: 8.07e-04
2025-12-14 08:33:25 | INFO     | Epoch  30/100 | Train Loss: 1.9032 Acc: 0.2955 | Val Loss: 1.9930 Acc: 0.1240 F1: 0.0512 | LR: 7.94e-04
2025-12-14 08:33:26 | INFO     | Epoch  31/100 | Train Loss: 1.8697 Acc: 0.2743 | Val Loss: 2.0092 Acc: 0.2039 F1: 0.0647 | LR: 7.81e-04
2025-12-14 08:33:26 | INFO     | Epoch  32/100 | Train Loss: 1.8588 Acc: 0.2479 | Val Loss: 2.0145 Acc: 0.3593 F1: 0.1016 | LR: 7.68e-04
2025-12-14 08:33:26 | INFO     | Epoch  33/100 | Train Loss: 1.8480 Acc: 0.2129 | Val Loss: 2.2349 Acc: 0.0571 F1: 0.0205 | LR: 7.55e-04
2025-12-14 08:33:26 | INFO     | Epoch  34/100 | Train Loss: 1.8767 Acc: 0.2041 | Val Loss: 1.9088 Acc: 0.1091 F1: 0.0473 | LR: 7.41e-04
2025-12-14 08:33:26 | INFO     | Early stopping at epoch 34
2025-12-14 08:33:26 | INFO     | ============================================================
2025-12-14 08:33:26 | INFO     | EVALUATING BEST MODEL ON TEST SET
2025-12-14 08:33:26 | INFO     | ============================================================
2025-12-14 08:33:26 | INFO     | 
Test Loss: 1.9737
2025-12-14 08:33:26 | INFO     | Test Accuracy: 0.6617
2025-12-14 08:33:26 | INFO     | ============================================================
SEQUENCE LABELING METRICS
============================================================

Standard Metrics:
  Accuracy:         0.6617
  F1 (micro):       0.6617
  F1 (macro):       0.1144
  F1 (weighted):    0.5936

Pattern Detection Metrics:
  Coverage Score:   0.0267
  Detection Rate:   0.0000
  False Alarm Rate: 0.8049
  Boundary Acc:     0.0119

Pattern-Level Metrics:
  Pattern Precision: 0.0000
  Pattern Recall:    0.0000
  Pattern F1:        0.0000

ROC-AUC (macro):     0.5001

Per-Class F1:
  None                : 0.8008
  Bearish Normal      : 0.0000
  Bearish Wedge       : 0.0000
  Bearish Pennant     : 0.0000
  Bullish Normal      : 0.0000
  Bullish Wedge       : 0.0000
  Bullish Pennant     : 0.0000
============================================================
2025-12-14 08:33:26 | INFO     | ============================================================
2025-12-14 08:33:26 | INFO     | TRAINING COMPLETE
2025-12-14 08:33:26 | INFO     | ============================================================
